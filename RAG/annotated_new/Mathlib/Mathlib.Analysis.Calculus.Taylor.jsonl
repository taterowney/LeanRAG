{"name":"taylorWithin_succ","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nn : Nat\ns : Set Real\nx‚ÇÄ : Real\n‚ä¢ Eq (taylorWithin f (HAdd.hAdd n 1) s x‚ÇÄ) (HAdd.hAdd (taylorWithin f n s x‚ÇÄ) ((PolynomialModule.comp (HSub.hSub Polynomial.X (Polynomial.C x‚ÇÄ))) ((PolynomialModule.single Real (HAdd.hAdd n 1)) (taylorCoeffWithin f (HAdd.hAdd n 1) s x‚ÇÄ))))","decl":"theorem taylorWithin_succ (f : ‚Ñù ‚Üí E) (n : ‚Ñï) (s : Set ‚Ñù) (x‚ÇÄ : ‚Ñù) :\n    taylorWithin f (n + 1) s x‚ÇÄ = taylorWithin f n s x‚ÇÄ +\n      PolynomialModule.comp (Polynomial.X - Polynomial.C x‚ÇÄ)\n      (PolynomialModule.single ‚Ñù (n + 1) (taylorCoeffWithin f (n + 1) s x‚ÇÄ)) := by\n  dsimp only [taylorWithin]\n  rw [Finset.sum_range_succ]\n\n"}
{"name":"taylorWithinEval_succ","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nn : Nat\ns : Set Real\nx‚ÇÄ x : Real\n‚ä¢ Eq (taylorWithinEval f (HAdd.hAdd n 1) s x‚ÇÄ x) (HAdd.hAdd (taylorWithinEval f n s x‚ÇÄ x) (HSMul.hSMul (HMul.hMul (Inv.inv (HMul.hMul (HAdd.hAdd (‚Üën) 1) ‚Üën.factorial)) (HPow.hPow (HSub.hSub x x‚ÇÄ) (HAdd.hAdd n 1))) (iteratedDerivWithin (HAdd.hAdd n 1) f s x‚ÇÄ)))","decl":"@[simp]\ntheorem taylorWithinEval_succ (f : ‚Ñù ‚Üí E) (n : ‚Ñï) (s : Set ‚Ñù) (x‚ÇÄ x : ‚Ñù) :\n    taylorWithinEval f (n + 1) s x‚ÇÄ x = taylorWithinEval f n s x‚ÇÄ x +\n      (((n + 1 : ‚Ñù) * n !)‚Åª¬π * (x - x‚ÇÄ) ^ (n + 1)) ‚Ä¢ iteratedDerivWithin (n + 1) f s x‚ÇÄ := by\n  simp_rw [taylorWithinEval, taylorWithin_succ, LinearMap.map_add, PolynomialModule.comp_eval]\n  congr\n  simp only [Polynomial.eval_sub, Polynomial.eval_X, Polynomial.eval_C,\n    PolynomialModule.eval_single, mul_inv_rev]\n  dsimp only [taylorCoeffWithin]\n  rw [‚Üê mul_smul, mul_comm, Nat.factorial_succ, Nat.cast_mul, Nat.cast_add, Nat.cast_one,\n    mul_inv_rev]\n\n"}
{"name":"taylor_within_zero_eval","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\ns : Set Real\nx‚ÇÄ x : Real\n‚ä¢ Eq (taylorWithinEval f 0 s x‚ÇÄ x) (f x‚ÇÄ)","decl":"/-- The Taylor polynomial of order zero evaluates to `f x`. -/\n@[simp]\ntheorem taylor_within_zero_eval (f : ‚Ñù ‚Üí E) (s : Set ‚Ñù) (x‚ÇÄ x : ‚Ñù) :\n    taylorWithinEval f 0 s x‚ÇÄ x = f x‚ÇÄ := by\n  dsimp only [taylorWithinEval]\n  dsimp only [taylorWithin]\n  dsimp only [taylorCoeffWithin]\n  simp\n\n"}
{"name":"taylorWithinEval_self","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nn : Nat\ns : Set Real\nx‚ÇÄ : Real\n‚ä¢ Eq (taylorWithinEval f n s x‚ÇÄ x‚ÇÄ) (f x‚ÇÄ)","decl":"/-- Evaluating the Taylor polynomial at `x = x‚ÇÄ` yields `f x`. -/\n@[simp]\ntheorem taylorWithinEval_self (f : ‚Ñù ‚Üí E) (n : ‚Ñï) (s : Set ‚Ñù) (x‚ÇÄ : ‚Ñù) :\n    taylorWithinEval f n s x‚ÇÄ x‚ÇÄ = f x‚ÇÄ := by\n  induction n with\n  | zero => exact taylor_within_zero_eval _ _ _ _\n  | succ k hk => simp [hk]\n\n"}
{"name":"taylor_within_apply","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nn : Nat\ns : Set Real\nx‚ÇÄ x : Real\n‚ä¢ Eq (taylorWithinEval f n s x‚ÇÄ x) ((Finset.range (HAdd.hAdd n 1)).sum fun k => HSMul.hSMul (HMul.hMul (Inv.inv ‚Üëk.factorial) (HPow.hPow (HSub.hSub x x‚ÇÄ) k)) (iteratedDerivWithin k f s x‚ÇÄ))","decl":"theorem taylor_within_apply (f : ‚Ñù ‚Üí E) (n : ‚Ñï) (s : Set ‚Ñù) (x‚ÇÄ x : ‚Ñù) :\n    taylorWithinEval f n s x‚ÇÄ x =\n      ‚àë k ‚àà Finset.range (n + 1), ((k ! : ‚Ñù)‚Åª¬π * (x - x‚ÇÄ) ^ k) ‚Ä¢ iteratedDerivWithin k f s x‚ÇÄ := by\n  induction n with\n  | zero => simp\n  | succ k hk =>\n    rw [taylorWithinEval_succ, Finset.sum_range_succ, hk]\n    simp [Nat.factorial]\n\n"}
{"name":"continuousOn_taylorWithinEval","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nx : Real\nn : Nat\ns : Set Real\nhs : UniqueDiffOn Real s\nhf : ContDiffOn Real (‚Üën) f s\n‚ä¢ ContinuousOn (fun t => taylorWithinEval f n s t x) s","decl":"/-- If `f` is `n` times continuous differentiable on a set `s`, then the Taylor polynomial\n  `taylorWithinEval f n s x‚ÇÄ x` is continuous in `x‚ÇÄ`. -/\ntheorem continuousOn_taylorWithinEval {f : ‚Ñù ‚Üí E} {x : ‚Ñù} {n : ‚Ñï} {s : Set ‚Ñù}\n    (hs : UniqueDiffOn ‚Ñù s) (hf : ContDiffOn ‚Ñù n f s) :\n    ContinuousOn (fun t => taylorWithinEval f n s t x) s := by\n  simp_rw [taylor_within_apply]\n  refine continuousOn_finset_sum (Finset.range (n + 1)) fun i hi => ?_\n  refine (continuousOn_const.mul ((continuousOn_const.sub continuousOn_id).pow _)).smul ?_\n  rw [contDiffOn_nat_iff_continuousOn_differentiableOn_deriv hs] at hf\n  cases' hf with hf_left\n  specialize hf_left i\n  simp only [Finset.mem_range] at hi\n  refine hf_left ?_\n  simp only [WithTop.coe_le_coe, Nat.cast_le, Nat.lt_succ_iff.mp hi]\n\n"}
{"name":"monomial_has_deriv_aux","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"t x : Real\nn : Nat\n‚ä¢ HasDerivAt (fun y => HPow.hPow (HSub.hSub x y) (HAdd.hAdd n 1)) (HMul.hMul (Neg.neg (HAdd.hAdd (‚Üën) 1)) (HPow.hPow (HSub.hSub x t) n)) t","decl":"/-- Helper lemma for calculating the derivative of the monomial that appears in Taylor\nexpansions. -/\ntheorem monomial_has_deriv_aux (t x : ‚Ñù) (n : ‚Ñï) :\n    HasDerivAt (fun y => (x - y) ^ (n + 1)) (-(n + 1) * (x - t) ^ n) t := by\n  simp_rw [sub_eq_neg_add]\n  rw [‚Üê neg_one_mul, mul_comm (-1 : ‚Ñù), mul_assoc, mul_comm (-1 : ‚Ñù), ‚Üê mul_assoc]\n  convert HasDerivAt.pow (n + 1) ((hasDerivAt_id t).neg.add_const x)\n  simp only [Nat.cast_add, Nat.cast_one]\n\n"}
{"name":"hasDerivWithinAt_taylor_coeff_within","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nx y : Real\nk : Nat\ns t : Set Real\nht : UniqueDiffWithinAt Real t y\nhs : Membership.mem (nhdsWithin y t) s\nhf : DifferentiableWithinAt Real (iteratedDerivWithin (HAdd.hAdd k 1) f s) s y\n‚ä¢ HasDerivWithinAt (fun z => HSMul.hSMul (HMul.hMul (Inv.inv (HMul.hMul (HAdd.hAdd (‚Üëk) 1) ‚Üëk.factorial)) (HPow.hPow (HSub.hSub x z) (HAdd.hAdd k 1))) (iteratedDerivWithin (HAdd.hAdd k 1) f s z)) (HSub.hSub (HSMul.hSMul (HMul.hMul (Inv.inv (HMul.hMul (HAdd.hAdd (‚Üëk) 1) ‚Üëk.factorial)) (HPow.hPow (HSub.hSub x y) (HAdd.hAdd k 1))) (iteratedDerivWithin (HAdd.hAdd k 2) f s y)) (HSMul.hSMul (HMul.hMul (Inv.inv ‚Üëk.factorial) (HPow.hPow (HSub.hSub x y) k)) (iteratedDerivWithin (HAdd.hAdd k 1) f s y))) t y","decl":"theorem hasDerivWithinAt_taylor_coeff_within {f : ‚Ñù ‚Üí E} {x y : ‚Ñù} {k : ‚Ñï} {s t : Set ‚Ñù}\n    (ht : UniqueDiffWithinAt ‚Ñù t y) (hs : s ‚àà ùìù[t] y)\n    (hf : DifferentiableWithinAt ‚Ñù (iteratedDerivWithin (k + 1) f s) s y) :\n    HasDerivWithinAt\n      (fun z => (((k + 1 : ‚Ñù) * k !)‚Åª¬π * (x - z) ^ (k + 1)) ‚Ä¢ iteratedDerivWithin (k + 1) f s z)\n      ((((k + 1 : ‚Ñù) * k !)‚Åª¬π * (x - y) ^ (k + 1)) ‚Ä¢ iteratedDerivWithin (k + 2) f s y -\n        ((k ! : ‚Ñù)‚Åª¬π * (x - y) ^ k) ‚Ä¢ iteratedDerivWithin (k + 1) f s y) t y := by\n  replace hf :\n    HasDerivWithinAt (iteratedDerivWithin (k + 1) f s) (iteratedDerivWithin (k + 2) f s y) t y := by\n    convert (hf.mono_of_mem_nhdsWithin hs).hasDerivWithinAt using 1\n    rw [iteratedDerivWithin_succ]\n    exact (derivWithin_of_mem_nhdsWithin hs ht hf).symm\n  have : HasDerivWithinAt (fun t => ((k + 1 : ‚Ñù) * k !)‚Åª¬π * (x - t) ^ (k + 1))\n      (-((k ! : ‚Ñù)‚Åª¬π * (x - y) ^ k)) t y := by\n    -- Commuting the factors:\n    have : -((k ! : ‚Ñù)‚Åª¬π * (x - y) ^ k) = ((k + 1 : ‚Ñù) * k !)‚Åª¬π * (-(k + 1) * (x - y) ^ k) := by\n      field_simp; ring\n    rw [this]\n    exact (monomial_has_deriv_aux y x _).hasDerivWithinAt.const_mul _\n  convert this.smul hf using 1\n  field_simp\n  rw [neg_div, neg_smul, sub_eq_add_neg]\n\n"}
{"name":"hasDerivWithinAt_taylorWithinEval","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\nx y : Real\nn : Nat\ns s' : Set Real\nhs_unique : UniqueDiffOn Real s\nhs' : Membership.mem (nhdsWithin y s) s'\nhy : Membership.mem s' y\nh : HasSubset.Subset s' s\nhf : ContDiffOn Real (‚Üën) f s\nhf' : DifferentiableWithinAt Real (iteratedDerivWithin n f s) s y\n‚ä¢ HasDerivWithinAt (fun t => taylorWithinEval f n s t x) (HSMul.hSMul (HMul.hMul (Inv.inv ‚Üën.factorial) (HPow.hPow (HSub.hSub x y) n)) (iteratedDerivWithin (HAdd.hAdd n 1) f s y)) s' y","decl":"/-- Calculate the derivative of the Taylor polynomial with respect to `x‚ÇÄ`.\n\nVersion for arbitrary sets -/\ntheorem hasDerivWithinAt_taylorWithinEval {f : ‚Ñù ‚Üí E} {x y : ‚Ñù} {n : ‚Ñï} {s s' : Set ‚Ñù}\n    (hs_unique : UniqueDiffOn ‚Ñù s) (hs' : s' ‚àà ùìù[s] y)\n    (hy : y ‚àà s') (h : s' ‚äÜ s) (hf : ContDiffOn ‚Ñù n f s)\n    (hf' : DifferentiableWithinAt ‚Ñù (iteratedDerivWithin n f s) s y) :\n    HasDerivWithinAt (fun t => taylorWithinEval f n s t x)\n      (((n ! : ‚Ñù)‚Åª¬π * (x - y) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f s y) s' y := by\n  have hs'_unique : UniqueDiffWithinAt ‚Ñù s' y :=\n    UniqueDiffWithinAt.mono_nhds (hs_unique _ (h hy)) (nhdsWithin_le_iff.mpr hs')\n  induction n with\n  | zero =>\n    simp only [taylor_within_zero_eval, Nat.factorial_zero, Nat.cast_one, inv_one, pow_zero,\n      mul_one, zero_add, one_smul]\n    simp only [iteratedDerivWithin_zero] at hf'\n    rw [iteratedDerivWithin_one]\n    exact hf'.hasDerivWithinAt.mono h\n  | succ k hk =>\n    simp_rw [Nat.add_succ, taylorWithinEval_succ]\n    simp only [add_zero, Nat.factorial_succ, Nat.cast_mul, Nat.cast_add, Nat.cast_one]\n    have coe_lt_succ : (k : WithTop ‚Ñï) < k.succ := Nat.cast_lt.2 k.lt_succ_self\n    have hdiff : DifferentiableOn ‚Ñù (iteratedDerivWithin k f s) s' :=\n      (hf.differentiableOn_iteratedDerivWithin (mod_cast coe_lt_succ) hs_unique).mono h\n    specialize hk hf.of_succ ((hdiff y hy).mono_of_mem_nhdsWithin hs')\n    convert hk.add (hasDerivWithinAt_taylor_coeff_within hs'_unique\n      (nhdsWithin_mono _ h self_mem_nhdsWithin) hf') using 1\n    exact (add_sub_cancel _ _).symm\n\n"}
{"name":"taylorWithinEval_hasDerivAt_Ioo","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\na b t x : Real\nn : Nat\nhx : LT.lt a b\nht : Membership.mem (Set.Ioo a b) t\nhf : ContDiffOn Real (‚Üën) f (Set.Icc a b)\nhf' : DifferentiableOn Real (iteratedDerivWithin n f (Set.Icc a b)) (Set.Ioo a b)\n‚ä¢ HasDerivAt (fun y => taylorWithinEval f n (Set.Icc a b) y x) (HSMul.hSMul (HMul.hMul (Inv.inv ‚Üën.factorial) (HPow.hPow (HSub.hSub x t) n)) (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc a b) t)) t","decl":"/-- Calculate the derivative of the Taylor polynomial with respect to `x‚ÇÄ`.\n\nVersion for open intervals -/\ntheorem taylorWithinEval_hasDerivAt_Ioo {f : ‚Ñù ‚Üí E} {a b t : ‚Ñù} (x : ‚Ñù) {n : ‚Ñï} (hx : a < b)\n    (ht : t ‚àà Ioo a b) (hf : ContDiffOn ‚Ñù n f (Icc a b))\n    (hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc a b)) (Ioo a b)) :\n    HasDerivAt (fun y => taylorWithinEval f n (Icc a b) y x)\n      (((n ! : ‚Ñù)‚Åª¬π * (x - t) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc a b) t) t :=\n  have h_nhds : Ioo a b ‚àà ùìù t := isOpen_Ioo.mem_nhds ht\n  have h_nhds' : Ioo a b ‚àà ùìù[Icc a b] t := nhdsWithin_le_nhds h_nhds\n  (hasDerivWithinAt_taylorWithinEval (uniqueDiffOn_Icc hx) h_nhds' ht\n    Ioo_subset_Icc_self hf <| (hf' t ht).mono_of_mem_nhdsWithin h_nhds').hasDerivAt h_nhds\n\n"}
{"name":"hasDerivWithinAt_taylorWithinEval_at_Icc","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\na b t x : Real\nn : Nat\nhx : LT.lt a b\nht : Membership.mem (Set.Icc a b) t\nhf : ContDiffOn Real (‚Üën) f (Set.Icc a b)\nhf' : DifferentiableOn Real (iteratedDerivWithin n f (Set.Icc a b)) (Set.Icc a b)\n‚ä¢ HasDerivWithinAt (fun y => taylorWithinEval f n (Set.Icc a b) y x) (HSMul.hSMul (HMul.hMul (Inv.inv ‚Üën.factorial) (HPow.hPow (HSub.hSub x t) n)) (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc a b) t)) (Set.Icc a b) t","decl":"/-- Calculate the derivative of the Taylor polynomial with respect to `x‚ÇÄ`.\n\nVersion for closed intervals -/\ntheorem hasDerivWithinAt_taylorWithinEval_at_Icc {f : ‚Ñù ‚Üí E} {a b t : ‚Ñù} (x : ‚Ñù) {n : ‚Ñï}\n    (hx : a < b) (ht : t ‚àà Icc a b) (hf : ContDiffOn ‚Ñù n f (Icc a b))\n    (hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc a b)) (Icc a b)) :\n    HasDerivWithinAt (fun y => taylorWithinEval f n (Icc a b) y x)\n      (((n ! : ‚Ñù)‚Åª¬π * (x - t) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc a b) t) (Icc a b) t :=\n  hasDerivWithinAt_taylorWithinEval (uniqueDiffOn_Icc hx)\n    self_mem_nhdsWithin ht rfl.subset hf (hf' t ht)\n\n"}
{"name":"taylor_mean_remainder","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"f g g' : Real ‚Üí Real\nx x‚ÇÄ : Real\nn : Nat\nhx : LT.lt x‚ÇÄ x\nhf : ContDiffOn Real (‚Üën) f (Set.Icc x‚ÇÄ x)\nhf' : DifferentiableOn Real (iteratedDerivWithin n f (Set.Icc x‚ÇÄ x)) (Set.Ioo x‚ÇÄ x)\ngcont : ContinuousOn g (Set.Icc x‚ÇÄ x)\ngdiff : ‚àÄ (x_1 : Real), Membership.mem (Set.Ioo x‚ÇÄ x) x_1 ‚Üí HasDerivAt g (g' x_1) x_1\ng'_ne : ‚àÄ (x_1 : Real), Membership.mem (Set.Ioo x‚ÇÄ x) x_1 ‚Üí Ne (g' x_1) 0\n‚ä¢ Exists fun x' => And (Membership.mem (Set.Ioo x‚ÇÄ x) x') (Eq (HSub.hSub (f x) (taylorWithinEval f n (Set.Icc x‚ÇÄ x) x‚ÇÄ x)) (HSMul.hSMul (HDiv.hDiv (HMul.hMul (HDiv.hDiv (HPow.hPow (HSub.hSub x x') n) ‚Üën.factorial) (HSub.hSub (g x) (g x‚ÇÄ))) (g' x')) (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc x‚ÇÄ x) x')))","decl":"/-- **Taylor's theorem** with the general mean value form of the remainder.\n\nWe assume that `f` is `n+1`-times continuously differentiable in the closed set `Icc x‚ÇÄ x` and\n`n+1`-times differentiable on the open set `Ioo x‚ÇÄ x`, and `g` is a differentiable function on\n`Ioo x‚ÇÄ x` and continuous on `Icc x‚ÇÄ x`. Then there exists an `x' ‚àà Ioo x‚ÇÄ x` such that\n$$f(x) - (P_n f)(x‚ÇÄ, x) = \\frac{(x - x')^n}{n!} \\frac{g(x) - g(x‚ÇÄ)}{g' x'},$$\nwhere $P_n f$ denotes the Taylor polynomial of degree $n$. -/\ntheorem taylor_mean_remainder {f : ‚Ñù ‚Üí ‚Ñù} {g g' : ‚Ñù ‚Üí ‚Ñù} {x x‚ÇÄ : ‚Ñù} {n : ‚Ñï} (hx : x‚ÇÄ < x)\n    (hf : ContDiffOn ‚Ñù n f (Icc x‚ÇÄ x))\n    (hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc x‚ÇÄ x)) (Ioo x‚ÇÄ x))\n    (gcont : ContinuousOn g (Icc x‚ÇÄ x))\n    (gdiff : ‚àÄ x_1 : ‚Ñù, x_1 ‚àà Ioo x‚ÇÄ x ‚Üí HasDerivAt g (g' x_1) x_1)\n    (g'_ne : ‚àÄ x_1 : ‚Ñù, x_1 ‚àà Ioo x‚ÇÄ x ‚Üí g' x_1 ‚â† 0) :\n    ‚àÉ x' ‚àà Ioo x‚ÇÄ x, f x - taylorWithinEval f n (Icc x‚ÇÄ x) x‚ÇÄ x =\n    ((x - x') ^ n / n ! * (g x - g x‚ÇÄ) / g' x') ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc x‚ÇÄ x) x' := by\n  -- We apply the mean value theorem\n  rcases exists_ratio_hasDerivAt_eq_ratio_slope (fun t => taylorWithinEval f n (Icc x‚ÇÄ x) t x)\n      (fun t => ((n ! : ‚Ñù)‚Åª¬π * (x - t) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc x‚ÇÄ x) t) hx\n      (continuousOn_taylorWithinEval (uniqueDiffOn_Icc hx) hf)\n      (fun _ hy => taylorWithinEval_hasDerivAt_Ioo x hx hy hf hf') g g' gcont gdiff with ‚ü®y, hy, h‚ü©\n  use y, hy\n  -- The rest is simplifications and trivial calculations\n  simp only [taylorWithinEval_self] at h\n  rw [mul_comm, ‚Üê div_left_inj' (g'_ne y hy), mul_div_cancel_right‚ÇÄ _ (g'_ne y hy)] at h\n  rw [‚Üê h]\n  field_simp [g'_ne y hy]\n  ring\n\n"}
{"name":"taylor_mean_remainder_lagrange","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"f : Real ‚Üí Real\nx x‚ÇÄ : Real\nn : Nat\nhx : LT.lt x‚ÇÄ x\nhf : ContDiffOn Real (‚Üën) f (Set.Icc x‚ÇÄ x)\nhf' : DifferentiableOn Real (iteratedDerivWithin n f (Set.Icc x‚ÇÄ x)) (Set.Ioo x‚ÇÄ x)\n‚ä¢ Exists fun x' => And (Membership.mem (Set.Ioo x‚ÇÄ x) x') (Eq (HSub.hSub (f x) (taylorWithinEval f n (Set.Icc x‚ÇÄ x) x‚ÇÄ x)) (HDiv.hDiv (HMul.hMul (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc x‚ÇÄ x) x') (HPow.hPow (HSub.hSub x x‚ÇÄ) (HAdd.hAdd n 1))) ‚Üë(HAdd.hAdd n 1).factorial))","decl":"/-- **Taylor's theorem** with the Lagrange form of the remainder.\n\nWe assume that `f` is `n+1`-times continuously differentiable in the closed set `Icc x‚ÇÄ x` and\n`n+1`-times differentiable on the open set `Ioo x‚ÇÄ x`. Then there exists an `x' ‚àà Ioo x‚ÇÄ x` such\nthat $$f(x) - (P_n f)(x‚ÇÄ, x) = \\frac{f^{(n+1)}(x') (x - x‚ÇÄ)^{n+1}}{(n+1)!},$$\nwhere $P_n f$ denotes the Taylor polynomial of degree $n$ and $f^{(n+1)}$ is the $n+1$-th iterated\nderivative. -/\ntheorem taylor_mean_remainder_lagrange {f : ‚Ñù ‚Üí ‚Ñù} {x x‚ÇÄ : ‚Ñù} {n : ‚Ñï} (hx : x‚ÇÄ < x)\n    (hf : ContDiffOn ‚Ñù n f (Icc x‚ÇÄ x))\n    (hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc x‚ÇÄ x)) (Ioo x‚ÇÄ x)) :\n    ‚àÉ x' ‚àà Ioo x‚ÇÄ x, f x - taylorWithinEval f n (Icc x‚ÇÄ x) x‚ÇÄ x =\n      iteratedDerivWithin (n + 1) f (Icc x‚ÇÄ x) x' * (x - x‚ÇÄ) ^ (n + 1) / (n + 1)! := by\n  have gcont : ContinuousOn (fun t : ‚Ñù => (x - t) ^ (n + 1)) (Icc x‚ÇÄ x) := by fun_prop\n  have xy_ne : ‚àÄ y : ‚Ñù, y ‚àà Ioo x‚ÇÄ x ‚Üí (x - y) ^ n ‚â† 0 := by\n    intro y hy\n    refine pow_ne_zero _ ?_\n    rw [mem_Ioo] at hy\n    rw [sub_ne_zero]\n    exact hy.2.ne'\n  have hg' : ‚àÄ y : ‚Ñù, y ‚àà Ioo x‚ÇÄ x ‚Üí -(‚Üën + 1) * (x - y) ^ n ‚â† 0 := fun y hy =>\n    mul_ne_zero (neg_ne_zero.mpr (Nat.cast_add_one_ne_zero n)) (xy_ne y hy)\n  -- We apply the general theorem with g(t) = (x - t)^(n+1)\n  rcases taylor_mean_remainder hx hf hf' gcont (fun y _ => monomial_has_deriv_aux y x _) hg' with\n    ‚ü®y, hy, h‚ü©\n  use y, hy\n  simp only [sub_self, zero_pow, Ne, Nat.succ_ne_zero, not_false_iff, zero_sub, mul_neg] at h\n  rw [h, neg_div, ‚Üê div_neg, neg_mul, neg_neg]\n  field_simp [xy_ne y hy, Nat.factorial]; ring\n\n"}
{"name":"taylor_mean_remainder_cauchy","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"f : Real ‚Üí Real\nx x‚ÇÄ : Real\nn : Nat\nhx : LT.lt x‚ÇÄ x\nhf : ContDiffOn Real (‚Üën) f (Set.Icc x‚ÇÄ x)\nhf' : DifferentiableOn Real (iteratedDerivWithin n f (Set.Icc x‚ÇÄ x)) (Set.Ioo x‚ÇÄ x)\n‚ä¢ Exists fun x' => And (Membership.mem (Set.Ioo x‚ÇÄ x) x') (Eq (HSub.hSub (f x) (taylorWithinEval f n (Set.Icc x‚ÇÄ x) x‚ÇÄ x)) (HMul.hMul (HDiv.hDiv (HMul.hMul (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc x‚ÇÄ x) x') (HPow.hPow (HSub.hSub x x') n)) ‚Üën.factorial) (HSub.hSub x x‚ÇÄ)))","decl":"/-- **Taylor's theorem** with the Cauchy form of the remainder.\n\nWe assume that `f` is `n+1`-times continuously differentiable on the closed set `Icc x‚ÇÄ x` and\n`n+1`-times differentiable on the open set `Ioo x‚ÇÄ x`. Then there exists an `x' ‚àà Ioo x‚ÇÄ x` such\nthat $$f(x) - (P_n f)(x‚ÇÄ, x) = \\frac{f^{(n+1)}(x') (x - x')^n (x-x‚ÇÄ)}{n!},$$\nwhere $P_n f$ denotes the Taylor polynomial of degree $n$ and $f^{(n+1)}$ is the $n+1$-th iterated\nderivative. -/\ntheorem taylor_mean_remainder_cauchy {f : ‚Ñù ‚Üí ‚Ñù} {x x‚ÇÄ : ‚Ñù} {n : ‚Ñï} (hx : x‚ÇÄ < x)\n    (hf : ContDiffOn ‚Ñù n f (Icc x‚ÇÄ x))\n    (hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc x‚ÇÄ x)) (Ioo x‚ÇÄ x)) :\n    ‚àÉ x' ‚àà Ioo x‚ÇÄ x, f x - taylorWithinEval f n (Icc x‚ÇÄ x) x‚ÇÄ x =\n      iteratedDerivWithin (n + 1) f (Icc x‚ÇÄ x) x' * (x - x') ^ n / n ! * (x - x‚ÇÄ) := by\n  have gcont : ContinuousOn id (Icc x‚ÇÄ x) := by fun_prop\n  have gdiff : ‚àÄ x_1 : ‚Ñù, x_1 ‚àà Ioo x‚ÇÄ x ‚Üí HasDerivAt id ((fun _ : ‚Ñù => (1 : ‚Ñù)) x_1) x_1 :=\n    fun _ _ => hasDerivAt_id _\n  -- We apply the general theorem with g = id\n  rcases taylor_mean_remainder hx hf hf' gcont gdiff fun _ _ => by simp with ‚ü®y, hy, h‚ü©\n  use y, hy\n  rw [h]\n  field_simp [n.factorial_ne_zero]\n  ring\n\n"}
{"name":"taylor_mean_remainder_bound","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\na b C x : Real\nn : Nat\nhab : LE.le a b\nhf : ContDiffOn Real (HAdd.hAdd (‚Üën) 1) f (Set.Icc a b)\nhx : Membership.mem (Set.Icc a b) x\nhC : ‚àÄ (y : Real), Membership.mem (Set.Icc a b) y ‚Üí LE.le (Norm.norm (iteratedDerivWithin (HAdd.hAdd n 1) f (Set.Icc a b) y)) C\n‚ä¢ LE.le (Norm.norm (HSub.hSub (f x) (taylorWithinEval f n (Set.Icc a b) a x))) (HDiv.hDiv (HMul.hMul C (HPow.hPow (HSub.hSub x a) (HAdd.hAdd n 1))) ‚Üën.factorial)","decl":"/-- **Taylor's theorem** with a polynomial bound on the remainder\n\nWe assume that `f` is `n+1`-times continuously differentiable on the closed set `Icc a b`.\nThe difference of `f` and its `n`-th Taylor polynomial can be estimated by\n`C * (x - a)^(n+1) / n!` where `C` is a bound for the `n+1`-th iterated derivative of `f`. -/\ntheorem taylor_mean_remainder_bound {f : ‚Ñù ‚Üí E} {a b C x : ‚Ñù} {n : ‚Ñï} (hab : a ‚â§ b)\n    (hf : ContDiffOn ‚Ñù (n + 1) f (Icc a b)) (hx : x ‚àà Icc a b)\n    (hC : ‚àÄ y ‚àà Icc a b, ‚ÄñiteratedDerivWithin (n + 1) f (Icc a b) y‚Äñ ‚â§ C) :\n    ‚Äñf x - taylorWithinEval f n (Icc a b) a x‚Äñ ‚â§ C * (x - a) ^ (n + 1) / n ! := by\n  rcases eq_or_lt_of_le hab with (rfl | h)\n  ¬∑ rw [Icc_self, mem_singleton_iff] at hx\n    simp [hx]\n  -- The nth iterated derivative is differentiable\n  have hf' : DifferentiableOn ‚Ñù (iteratedDerivWithin n f (Icc a b)) (Icc a b) :=\n    hf.differentiableOn_iteratedDerivWithin (mod_cast n.lt_succ_self)\n      (uniqueDiffOn_Icc h)\n  -- We can uniformly bound the derivative of the Taylor polynomial\n  have h' : ‚àÄ y ‚àà Ico a x,\n      ‚Äñ((n ! : ‚Ñù)‚Åª¬π * (x - y) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc a b) y‚Äñ ‚â§\n        (n ! : ‚Ñù)‚Åª¬π * |x - a| ^ n * C := by\n    rintro y ‚ü®hay, hyx‚ü©\n    rw [norm_smul, Real.norm_eq_abs]\n    gcongr\n    ¬∑ rw [abs_mul, abs_pow, abs_inv, Nat.abs_cast]\n      gcongr\n      exact sub_nonneg.2 hyx.le\n    -- Estimate the iterated derivative by `C`\n    ¬∑ exact hC y ‚ü®hay, hyx.le.trans hx.2‚ü©\n  -- Apply the mean value theorem for vector valued functions:\n  have A : ‚àÄ t ‚àà Icc a x, HasDerivWithinAt (fun y => taylorWithinEval f n (Icc a b) y x)\n      (((‚Üën !)‚Åª¬π * (x - t) ^ n) ‚Ä¢ iteratedDerivWithin (n + 1) f (Icc a b) t) (Icc a x) t := by\n    intro t ht\n    have I : Icc a x ‚äÜ Icc a b := Icc_subset_Icc_right hx.2\n    exact (hasDerivWithinAt_taylorWithinEval_at_Icc x h (I ht) hf.of_succ hf').mono I\n  have := norm_image_sub_le_of_norm_deriv_le_segment' A h' x (right_mem_Icc.2 hx.1)\n  simp only [taylorWithinEval_self] at this\n  refine this.trans_eq ?_\n  -- The rest is a trivial calculation\n  rw [abs_of_nonneg (sub_nonneg.mpr hx.1)]\n  ring\n\n"}
{"name":"exists_taylor_mean_remainder_bound","module":"Mathlib.Analysis.Calculus.Taylor","initialProofState":"E : Type u_2\ninst‚úù¬π : NormedAddCommGroup E\ninst‚úù : NormedSpace Real E\nf : Real ‚Üí E\na b : Real\nn : Nat\nhab : LE.le a b\nhf : ContDiffOn Real (HAdd.hAdd (‚Üën) 1) f (Set.Icc a b)\n‚ä¢ Exists fun C => ‚àÄ (x : Real), Membership.mem (Set.Icc a b) x ‚Üí LE.le (Norm.norm (HSub.hSub (f x) (taylorWithinEval f n (Set.Icc a b) a x))) (HMul.hMul C (HPow.hPow (HSub.hSub x a) (HAdd.hAdd n 1)))","decl":"/-- **Taylor's theorem** with a polynomial bound on the remainder\n\nWe assume that `f` is `n+1`-times continuously differentiable on the closed set `Icc a b`.\nThere exists a constant `C` such that for all `x ‚àà Icc a b` the difference of `f` and its `n`-th\nTaylor polynomial can be estimated by `C * (x - a)^(n+1)`. -/\ntheorem exists_taylor_mean_remainder_bound {f : ‚Ñù ‚Üí E} {a b : ‚Ñù} {n : ‚Ñï} (hab : a ‚â§ b)\n    (hf : ContDiffOn ‚Ñù (n + 1) f (Icc a b)) :\n    ‚àÉ C, ‚àÄ x ‚àà Icc a b, ‚Äñf x - taylorWithinEval f n (Icc a b) a x‚Äñ ‚â§ C * (x - a) ^ (n + 1) := by\n  rcases eq_or_lt_of_le hab with (rfl | h)\n  ¬∑ refine ‚ü®0, fun x hx => ?_‚ü©\n    have : x = a := by simpa [‚Üê le_antisymm_iff] using hx\n    simp [‚Üê this]\n  -- We estimate by the supremum of the norm of the iterated derivative\n  let g : ‚Ñù ‚Üí ‚Ñù := fun y => ‚ÄñiteratedDerivWithin (n + 1) f (Icc a b) y‚Äñ\n  use SupSet.sSup (g '' Icc a b) / (n !)\n  intro x hx\n  rw [div_mul_eq_mul_div‚ÇÄ]\n  refine taylor_mean_remainder_bound hab hf hx fun y => ?_\n  exact (hf.continuousOn_iteratedDerivWithin rfl.le <| uniqueDiffOn_Icc h).norm.le_sSup_image_Icc\n"}
