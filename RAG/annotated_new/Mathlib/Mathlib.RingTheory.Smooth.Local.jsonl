{"name":"Algebra.FormallySmooth.iff_injective_lTensor_residueField","module":"Mathlib.RingTheory.Smooth.Local","initialProofState":"R S : Type u_1\ninst✝⁶ : CommRing R\ninst✝⁵ : CommRing S\ninst✝⁴ : IsLocalRing S\ninst✝³ : Algebra R S\nP : Algebra.Extension R S\ninst✝² : Algebra.FormallySmooth R P.Ring\ninst✝¹ : Module.Free P.Ring (KaehlerDifferential R P.Ring)\ninst✝ : Module.Finite P.Ring (KaehlerDifferential R P.Ring)\nh' : P.ker.FG\n⊢ Iff (Algebra.FormallySmooth R S) (Function.Injective ⇑(LinearMap.lTensor (IsLocalRing.ResidueField S) P.cotangentComplex))","decl":"/--\nThe **Jacobian criterion** for smoothness of local algebras.\nSuppose `S` is a local `R`-algebra, and `0 → I → P → S → 0` is a presentation such that\n`P` is formally-smooth over `R`, `Ω[P⁄R]` is finite free over `P`,\n(typically satisfied when `P` is the localization of a polynomial ring of finite type)\nand `I` is finitely generated.\nThen `S` is formally smooth iff `k ⊗ₛ I/I² → k ⊗ₚ Ω[P/R]` is injective,\nwhere `k` is the residue field of `S`.\n-/\ntheorem Algebra.FormallySmooth.iff_injective_lTensor_residueField {R S} [CommRing R]\n    [CommRing S] [IsLocalRing S] [Algebra R S] (P : Algebra.Extension R S)\n    [FormallySmooth R P.Ring]\n    [Module.Free P.Ring (Ω[P.Ring⁄R])] [Module.Finite P.Ring (Ω[P.Ring⁄R])]\n    (h' : P.ker.FG) :\n    Algebra.FormallySmooth R S ↔\n        Function.Injective (P.cotangentComplex.lTensor (ResidueField S)) := by\n  have : Module.Finite P.Ring P.Cotangent :=\n    have : Module.Finite P.Ring P.ker := ⟨(Submodule.fg_top _).mpr h'⟩\n    .of_surjective _ Extension.Cotangent.mk_surjective\n  have : Module.Finite S P.Cotangent := Module.Finite.of_restrictScalars_finite P.Ring _ _\n  rw [← IsLocalRing.split_injective_iff_lTensor_residueField_injective,\n    P.formallySmooth_iff_split_injection]\n"}
