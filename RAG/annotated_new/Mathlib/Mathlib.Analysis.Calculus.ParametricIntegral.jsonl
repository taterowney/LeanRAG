{"name":"hasFDerivAt_integral_of_dominated_loc_of_lip'","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"Î± : Type u_1\ninstâœâ¶ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\nğ•œ : Type u_2\ninstâœâµ : RCLike ğ•œ\nE : Type u_3\ninstâœâ´ : NormedAddCommGroup E\ninstâœÂ³ : NormedSpace Real E\ninstâœÂ² : NormedSpace ğ•œ E\nH : Type u_4\ninstâœÂ¹ : NormedAddCommGroup H\ninstâœ : NormedSpace ğ•œ H\nF : H â†’ Î± â†’ E\nxâ‚€ : H\nbound : Î± â†’ Real\nÎµ : Real\nF' : Î± â†’ ContinuousLinearMap (RingHom.id ğ•œ) H E\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ MeasureTheory.AEStronglyMeasurable (F x) Î¼\nhF_int : MeasureTheory.Integrable (F xâ‚€) Î¼\nhF'_meas : MeasureTheory.AEStronglyMeasurable F' Î¼\nh_lipsch : Filter.Eventually (fun a => âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ LE.le (Norm.norm (HSub.hSub (F x a) (F xâ‚€ a))) (HMul.hMul (bound a) (Norm.norm (HSub.hSub x xâ‚€)))) (MeasureTheory.ae Î¼)\nbound_integrable : MeasureTheory.Integrable bound Î¼\nh_diff : Filter.Eventually (fun a => HasFDerivAt (fun x => F x a) (F' a) xâ‚€) (MeasureTheory.ae Î¼)\nâŠ¢ And (MeasureTheory.Integrable F' Î¼) (HasFDerivAt (fun x => MeasureTheory.integral Î¼ fun a => F x a) (MeasureTheory.integral Î¼ fun a => F' a) xâ‚€)","decl":"/-- Differentiation under integral of `x â†¦ âˆ« F x a` at a given point `xâ‚€`, assuming `F xâ‚€` is\nintegrable, `â€–F x a - F xâ‚€ aâ€– â‰¤ bound a * â€–x - xâ‚€â€–` for `x` in a ball around `xâ‚€` for ae `a` with\nintegrable Lipschitz bound `bound` (with a ball radius independent of `a`), and `F x` is\nae-measurable for `x` in the same ball. See `hasFDerivAt_integral_of_dominated_loc_of_lip` for a\nslightly less general but usually more useful version. -/\ntheorem hasFDerivAt_integral_of_dominated_loc_of_lip' {F' : Î± â†’ H â†’L[ğ•œ] E} (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€ x âˆˆ ball xâ‚€ Îµ, AEStronglyMeasurable (F x) Î¼) (hF_int : Integrable (F xâ‚€) Î¼)\n    (hF'_meas : AEStronglyMeasurable F' Î¼)\n    (h_lipsch : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, â€–F x a - F xâ‚€ aâ€– â‰¤ bound a * â€–x - xâ‚€â€–)\n    (bound_integrable : Integrable (bound : Î± â†’ â„) Î¼)\n    (h_diff : âˆ€áµ a âˆ‚Î¼, HasFDerivAt (F Â· a) (F' a) xâ‚€) :\n    Integrable F' Î¼ âˆ§ HasFDerivAt (fun x â†¦ âˆ« a, F x a âˆ‚Î¼) (âˆ« a, F' a âˆ‚Î¼) xâ‚€ := by\n  have xâ‚€_in : xâ‚€ âˆˆ ball xâ‚€ Îµ := mem_ball_self Îµ_pos\n  have nneg : âˆ€ x, 0 â‰¤ â€–x - xâ‚€â€–â»Â¹ := fun x â†¦ inv_nonneg.mpr (norm_nonneg _)\n  set b : Î± â†’ â„ := fun a â†¦ |bound a|\n  have b_int : Integrable b Î¼ := bound_integrable.norm\n  have b_nonneg : âˆ€ a, 0 â‰¤ b a := fun a â†¦ abs_nonneg _\n  replace h_lipsch : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, â€–F x a - F xâ‚€ aâ€– â‰¤ b a * â€–x - xâ‚€â€– :=\n    h_lipsch.mono fun a ha x hx â†¦\n      (ha x hx).trans <| mul_le_mul_of_nonneg_right (le_abs_self _) (norm_nonneg _)\n  have hF_int' : âˆ€ x âˆˆ ball xâ‚€ Îµ, Integrable (F x) Î¼ := fun x x_in â†¦ by\n    have : âˆ€áµ a âˆ‚Î¼, â€–F xâ‚€ a - F x aâ€– â‰¤ Îµ * b a := by\n      simp only [norm_sub_rev (F xâ‚€ _)]\n      refine h_lipsch.mono fun a ha â†¦ (ha x x_in).trans ?_\n      rw [mul_comm Îµ]\n      rw [mem_ball, dist_eq_norm] at x_in\n      exact mul_le_mul_of_nonneg_left x_in.le (b_nonneg _)\n    exact integrable_of_norm_sub_le (hF_meas x x_in) hF_int\n      (bound_integrable.norm.const_mul Îµ) this\n  have hF'_int : Integrable F' Î¼ :=\n    have : âˆ€áµ a âˆ‚Î¼, â€–F' aâ€– â‰¤ b a := by\n      apply (h_diff.and h_lipsch).mono\n      rintro a âŸ¨ha_diff, ha_lipâŸ©\n      exact ha_diff.le_of_lip' (b_nonneg a) (mem_of_superset (ball_mem_nhds _ Îµ_pos) <| ha_lip)\n    b_int.mono' hF'_meas this\n  refine âŸ¨hF'_int, ?_âŸ©\n  /- Discard the trivial case where `E` is not complete, as all integrals vanish. -/\n  by_cases hE : CompleteSpace E; swap\n  Â· rcases subsingleton_or_nontrivial H with hH|hH\n    Â· have : Subsingleton (H â†’L[ğ•œ] E) := inferInstance\n      convert hasFDerivAt_of_subsingleton _ xâ‚€\n    Â· have : Â¬(CompleteSpace (H â†’L[ğ•œ] E)) := by\n        simpa [SeparatingDual.completeSpace_continuousLinearMap_iff] using hE\n      simp only [integral, hE, â†“reduceDIte, this]\n      exact hasFDerivAt_const 0 xâ‚€\n  have h_ball : ball xâ‚€ Îµ âˆˆ ğ“ xâ‚€ := ball_mem_nhds xâ‚€ Îµ_pos\n  have : âˆ€á¶  x in ğ“ xâ‚€, â€–x - xâ‚€â€–â»Â¹ * â€–((âˆ« a, F x a âˆ‚Î¼) - âˆ« a, F xâ‚€ a âˆ‚Î¼) - (âˆ« a, F' a âˆ‚Î¼) (x - xâ‚€)â€– =\n      â€–âˆ« a, â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a - F' a (x - xâ‚€)) âˆ‚Î¼â€– := by\n    apply mem_of_superset (ball_mem_nhds _ Îµ_pos)\n    intro x x_in; simp only\n    rw [Set.mem_setOf_eq, â† norm_smul_of_nonneg (nneg _), integral_smul, integral_sub, integral_sub,\n      â† ContinuousLinearMap.integral_apply hF'_int]\n    exacts [hF_int' x x_in, hF_int, (hF_int' x x_in).sub hF_int,\n      hF'_int.apply_continuousLinearMap _]\n  rw [hasFDerivAt_iff_tendsto, tendsto_congr' this, â† tendsto_zero_iff_norm_tendsto_zero, â†\n    show (âˆ« a : Î±, â€–xâ‚€ - xâ‚€â€–â»Â¹ â€¢ (F xâ‚€ a - F xâ‚€ a - (F' a) (xâ‚€ - xâ‚€)) âˆ‚Î¼) = 0 by simp]\n  apply tendsto_integral_filter_of_dominated_convergence\n  Â· filter_upwards [h_ball] with _ x_in\n    apply AEStronglyMeasurable.const_smul\n    exact ((hF_meas _ x_in).sub (hF_meas _ xâ‚€_in)).sub (hF'_meas.apply_continuousLinearMap _)\n  Â· refine mem_of_superset h_ball fun x hx â†¦ ?_\n    apply (h_diff.and h_lipsch).mono\n    on_goal 1 => rintro a âŸ¨-, ha_boundâŸ©\n    show â€–â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a - F' a (x - xâ‚€))â€– â‰¤ b a + â€–F' aâ€–\n    replace ha_bound : â€–F x a - F xâ‚€ aâ€– â‰¤ b a * â€–x - xâ‚€â€– := ha_bound x hx\n    calc\n      â€–â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a - F' a (x - xâ‚€))â€– =\n          â€–â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a) - â€–x - xâ‚€â€–â»Â¹ â€¢ F' a (x - xâ‚€)â€– := by rw [smul_sub]\n      _ â‰¤ â€–â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a)â€– + â€–â€–x - xâ‚€â€–â»Â¹ â€¢ F' a (x - xâ‚€)â€– := norm_sub_le _ _\n      _ = â€–x - xâ‚€â€–â»Â¹ * â€–F x a - F xâ‚€ aâ€– + â€–x - xâ‚€â€–â»Â¹ * â€–F' a (x - xâ‚€)â€– := by\n        rw [norm_smul_of_nonneg, norm_smul_of_nonneg] <;> exact nneg _\n      _ â‰¤ â€–x - xâ‚€â€–â»Â¹ * (b a * â€–x - xâ‚€â€–) + â€–x - xâ‚€â€–â»Â¹ * (â€–F' aâ€– * â€–x - xâ‚€â€–) := by\n        gcongr; exact (F' a).le_opNorm _\n      _ â‰¤ b a + â€–F' aâ€– := ?_\n    simp only [â† div_eq_inv_mul]\n    apply_rules [add_le_add, div_le_of_le_mulâ‚€] <;> first | rfl | positivity\n  Â· exact b_int.add hF'_int.norm\n  Â· apply h_diff.mono\n    intro a ha\n    suffices Tendsto (fun x â†¦ â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a - F' a (x - xâ‚€))) (ğ“ xâ‚€) (ğ“ 0) by simpa\n    rw [tendsto_zero_iff_norm_tendsto_zero]\n    have : (fun x â†¦ â€–x - xâ‚€â€–â»Â¹ * â€–F x a - F xâ‚€ a - F' a (x - xâ‚€)â€–) = fun x â†¦\n        â€–â€–x - xâ‚€â€–â»Â¹ â€¢ (F x a - F xâ‚€ a - F' a (x - xâ‚€))â€– := by\n      ext x\n      rw [norm_smul_of_nonneg (nneg _)]\n    rwa [hasFDerivAt_iff_tendsto, this] at ha\n\n"}
{"name":"hasFDerivAt_integral_of_dominated_loc_of_lip","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"Î± : Type u_1\ninstâœâ¶ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\nğ•œ : Type u_2\ninstâœâµ : RCLike ğ•œ\nE : Type u_3\ninstâœâ´ : NormedAddCommGroup E\ninstâœÂ³ : NormedSpace Real E\ninstâœÂ² : NormedSpace ğ•œ E\nH : Type u_4\ninstâœÂ¹ : NormedAddCommGroup H\ninstâœ : NormedSpace ğ•œ H\nF : H â†’ Î± â†’ E\nxâ‚€ : H\nbound : Î± â†’ Real\nÎµ : Real\nF' : Î± â†’ ContinuousLinearMap (RingHom.id ğ•œ) H E\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) Î¼) (nhds xâ‚€)\nhF_int : MeasureTheory.Integrable (F xâ‚€) Î¼\nhF'_meas : MeasureTheory.AEStronglyMeasurable F' Î¼\nh_lip : Filter.Eventually (fun a => LipschitzOnWith (Real.nnabs (bound a)) (fun x => F x a) (Metric.ball xâ‚€ Îµ)) (MeasureTheory.ae Î¼)\nbound_integrable : MeasureTheory.Integrable bound Î¼\nh_diff : Filter.Eventually (fun a => HasFDerivAt (fun x => F x a) (F' a) xâ‚€) (MeasureTheory.ae Î¼)\nâŠ¢ And (MeasureTheory.Integrable F' Î¼) (HasFDerivAt (fun x => MeasureTheory.integral Î¼ fun a => F x a) (MeasureTheory.integral Î¼ fun a => F' a) xâ‚€)","decl":"/-- Differentiation under integral of `x â†¦ âˆ« F x a` at a given point `xâ‚€`, assuming\n`F xâ‚€` is integrable, `x â†¦ F x a` is locally Lipschitz on a ball around `xâ‚€` for ae `a`\n(with a ball radius independent of `a`) with integrable Lipschitz bound, and `F x` is ae-measurable\nfor `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasFDerivAt_integral_of_dominated_loc_of_lip {F' : Î± â†’ H â†’L[ğ•œ] E}\n    (Îµ_pos : 0 < Îµ) (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) Î¼)\n    (hF_int : Integrable (F xâ‚€) Î¼) (hF'_meas : AEStronglyMeasurable F' Î¼)\n    (h_lip : âˆ€áµ a âˆ‚Î¼, LipschitzOnWith (Real.nnabs <| bound a) (F Â· a) (ball xâ‚€ Îµ))\n    (bound_integrable : Integrable (bound : Î± â†’ â„) Î¼)\n    (h_diff : âˆ€áµ a âˆ‚Î¼, HasFDerivAt (F Â· a) (F' a) xâ‚€) :\n    Integrable F' Î¼ âˆ§ HasFDerivAt (fun x â†¦ âˆ« a, F x a âˆ‚Î¼) (âˆ« a, F' a âˆ‚Î¼) xâ‚€ := by\n  obtain âŸ¨Î´, Î´_pos, hÎ´âŸ© : âˆƒ Î´ > 0, âˆ€ x âˆˆ ball xâ‚€ Î´, AEStronglyMeasurable (F x) Î¼ âˆ§ x âˆˆ ball xâ‚€ Îµ :=\n    eventually_nhds_iff_ball.mp (hF_meas.and (ball_mem_nhds xâ‚€ Îµ_pos))\n  choose hÎ´_meas hÎ´Îµ using hÎ´\n  replace h_lip : âˆ€áµ a : Î± âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Î´, â€–F x a - F xâ‚€ aâ€– â‰¤ |bound a| * â€–x - xâ‚€â€– :=\n    h_lip.mono fun a lip x hx â†¦ lip.norm_sub_le (hÎ´Îµ x hx) (mem_ball_self Îµ_pos)\n  replace bound_integrable := bound_integrable.norm\n  apply hasFDerivAt_integral_of_dominated_loc_of_lip' Î´_pos <;> assumption\n\n"}
{"name":"hasFDerivAt_integral_of_dominated_loc_of_lip_interval","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"E : Type u_3\ninstâœÂ³ : NormedAddCommGroup E\ninstâœÂ² : NormedSpace Real E\nH : Type u_4\ninstâœÂ¹ : NormedAddCommGroup H\nxâ‚€ : H\nÎµ : Real\ninstâœ : NormedSpace Real H\nÎ¼ : MeasureTheory.Measure Real\nF : H â†’ Real â†’ E\nF' : Real â†’ ContinuousLinearMap (RingHom.id Real) H E\na b : Real\nbound : Real â†’ Real\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) (Î¼.restrict (Set.uIoc a b))) (nhds xâ‚€)\nhF_int : IntervalIntegrable (F xâ‚€) Î¼ a b\nhF'_meas : MeasureTheory.AEStronglyMeasurable F' (Î¼.restrict (Set.uIoc a b))\nh_lip : Filter.Eventually (fun t => LipschitzOnWith (Real.nnabs (bound t)) (fun x => F x t) (Metric.ball xâ‚€ Îµ)) (MeasureTheory.ae (Î¼.restrict (Set.uIoc a b)))\nbound_integrable : IntervalIntegrable bound Î¼ a b\nh_diff : Filter.Eventually (fun t => HasFDerivAt (fun x => F x t) (F' t) xâ‚€) (MeasureTheory.ae (Î¼.restrict (Set.uIoc a b)))\nâŠ¢ And (IntervalIntegrable F' Î¼ a b) (HasFDerivAt (fun x => intervalIntegral (fun t => F x t) a b Î¼) (intervalIntegral (fun t => F' t) a b Î¼) xâ‚€)","decl":"/-- Differentiation under integral of `x â†¦ âˆ« x in a..b, F x t` at a given point `xâ‚€ âˆˆ (a,b)`,\nassuming `F xâ‚€` is integrable on `(a,b)`, that `x â†¦ F x t` is Lipschitz on a ball around `xâ‚€`\nfor almost every `t` (with a ball radius independent of `t`) with integrable Lipschitz bound,\nand `F x` is a.e.-measurable for `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasFDerivAt_integral_of_dominated_loc_of_lip_interval [NormedSpace â„ H] {Î¼ : Measure â„}\n    {F : H â†’ â„ â†’ E} {F' : â„ â†’ H â†’L[â„] E} {a b : â„} {bound : â„ â†’ â„} (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) <| Î¼.restrict (Î™ a b))\n    (hF_int : IntervalIntegrable (F xâ‚€) Î¼ a b)\n    (hF'_meas : AEStronglyMeasurable F' <| Î¼.restrict (Î™ a b))\n    (h_lip : âˆ€áµ t âˆ‚Î¼.restrict (Î™ a b),\n      LipschitzOnWith (Real.nnabs <| bound t) (F Â· t) (ball xâ‚€ Îµ))\n    (bound_integrable : IntervalIntegrable bound Î¼ a b)\n    (h_diff : âˆ€áµ t âˆ‚Î¼.restrict (Î™ a b), HasFDerivAt (F Â· t) (F' t) xâ‚€) :\n    IntervalIntegrable F' Î¼ a b âˆ§\n      HasFDerivAt (fun x â†¦ âˆ« t in a..b, F x t âˆ‚Î¼) (âˆ« t in a..b, F' t âˆ‚Î¼) xâ‚€ := by\n  simp_rw [AEStronglyMeasurable.aestronglyMeasurable_uIoc_iff, eventually_and] at hF_meas hF'_meas\n  rw [ae_restrict_uIoc_iff] at h_lip h_diff\n  have Hâ‚ :=\n    hasFDerivAt_integral_of_dominated_loc_of_lip Îµ_pos hF_meas.1 hF_int.1 hF'_meas.1 h_lip.1\n      bound_integrable.1 h_diff.1\n  have Hâ‚‚ :=\n    hasFDerivAt_integral_of_dominated_loc_of_lip Îµ_pos hF_meas.2 hF_int.2 hF'_meas.2 h_lip.2\n      bound_integrable.2 h_diff.2\n  exact âŸ¨âŸ¨Hâ‚.1, Hâ‚‚.1âŸ©, Hâ‚.2.sub Hâ‚‚.2âŸ©\n\n"}
{"name":"hasFDerivAt_integral_of_dominated_of_fderiv_le","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"Î± : Type u_1\ninstâœâ¶ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\nğ•œ : Type u_2\ninstâœâµ : RCLike ğ•œ\nE : Type u_3\ninstâœâ´ : NormedAddCommGroup E\ninstâœÂ³ : NormedSpace Real E\ninstâœÂ² : NormedSpace ğ•œ E\nH : Type u_4\ninstâœÂ¹ : NormedAddCommGroup H\ninstâœ : NormedSpace ğ•œ H\nF : H â†’ Î± â†’ E\nxâ‚€ : H\nbound : Î± â†’ Real\nÎµ : Real\nF' : H â†’ Î± â†’ ContinuousLinearMap (RingHom.id ğ•œ) H E\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) Î¼) (nhds xâ‚€)\nhF_int : MeasureTheory.Integrable (F xâ‚€) Î¼\nhF'_meas : MeasureTheory.AEStronglyMeasurable (F' xâ‚€) Î¼\nh_bound : Filter.Eventually (fun a => âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ LE.le (Norm.norm (F' x a)) (bound a)) (MeasureTheory.ae Î¼)\nbound_integrable : MeasureTheory.Integrable bound Î¼\nh_diff : Filter.Eventually (fun a => âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ HasFDerivAt (fun x => F x a) (F' x a) x) (MeasureTheory.ae Î¼)\nâŠ¢ HasFDerivAt (fun x => MeasureTheory.integral Î¼ fun a => F x a) (MeasureTheory.integral Î¼ fun a => F' xâ‚€ a) xâ‚€","decl":"/-- Differentiation under integral of `x â†¦ âˆ« F x a` at a given point `xâ‚€`, assuming\n`F xâ‚€` is integrable, `x â†¦ F x a` is differentiable on a ball around `xâ‚€` for ae `a` with\nderivative norm uniformly bounded by an integrable function (the ball radius is independent of `a`),\nand `F x` is ae-measurable for `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasFDerivAt_integral_of_dominated_of_fderiv_le {F' : H â†’ Î± â†’ H â†’L[ğ•œ] E} (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) Î¼) (hF_int : Integrable (F xâ‚€) Î¼)\n    (hF'_meas : AEStronglyMeasurable (F' xâ‚€) Î¼)\n    (h_bound : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, â€–F' x aâ€– â‰¤ bound a)\n    (bound_integrable : Integrable (bound : Î± â†’ â„) Î¼)\n    (h_diff : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, HasFDerivAt (F Â· a) (F' x a) x) :\n    HasFDerivAt (fun x â†¦ âˆ« a, F x a âˆ‚Î¼) (âˆ« a, F' xâ‚€ a âˆ‚Î¼) xâ‚€ := by\n  letI : NormedSpace â„ H := NormedSpace.restrictScalars â„ ğ•œ H\n  have xâ‚€_in : xâ‚€ âˆˆ ball xâ‚€ Îµ := mem_ball_self Îµ_pos\n  have diff_xâ‚€ : âˆ€áµ a âˆ‚Î¼, HasFDerivAt (F Â· a) (F' xâ‚€ a) xâ‚€ :=\n    h_diff.mono fun a ha â†¦ ha xâ‚€ xâ‚€_in\n  have : âˆ€áµ a âˆ‚Î¼, LipschitzOnWith (Real.nnabs (bound a)) (F Â· a) (ball xâ‚€ Îµ) := by\n    apply (h_diff.and h_bound).mono\n    rintro a âŸ¨ha_deriv, ha_boundâŸ©\n    refine (convex_ball _ _).lipschitzOnWith_of_nnnorm_hasFDerivWithin_le\n      (fun x x_in â†¦ (ha_deriv x x_in).hasFDerivWithinAt) fun x x_in â†¦ ?_\n    rw [â† NNReal.coe_le_coe, coe_nnnorm, Real.coe_nnabs]\n    exact (ha_bound x x_in).trans (le_abs_self _)\n  exact (hasFDerivAt_integral_of_dominated_loc_of_lip Îµ_pos hF_meas hF_int hF'_meas this\n    bound_integrable diff_xâ‚€).2\n\n"}
{"name":"hasFDerivAt_integral_of_dominated_of_fderiv_le''","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"E : Type u_3\ninstâœÂ³ : NormedAddCommGroup E\ninstâœÂ² : NormedSpace Real E\nH : Type u_4\ninstâœÂ¹ : NormedAddCommGroup H\nxâ‚€ : H\nÎµ : Real\ninstâœ : NormedSpace Real H\nÎ¼ : MeasureTheory.Measure Real\nF : H â†’ Real â†’ E\nF' : H â†’ Real â†’ ContinuousLinearMap (RingHom.id Real) H E\na b : Real\nbound : Real â†’ Real\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) (Î¼.restrict (Set.uIoc a b))) (nhds xâ‚€)\nhF_int : IntervalIntegrable (F xâ‚€) Î¼ a b\nhF'_meas : MeasureTheory.AEStronglyMeasurable (F' xâ‚€) (Î¼.restrict (Set.uIoc a b))\nh_bound : Filter.Eventually (fun t => âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ LE.le (Norm.norm (F' x t)) (bound t)) (MeasureTheory.ae (Î¼.restrict (Set.uIoc a b)))\nbound_integrable : IntervalIntegrable bound Î¼ a b\nh_diff : Filter.Eventually (fun t => âˆ€ (x : H), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ HasFDerivAt (fun x => F x t) (F' x t) x) (MeasureTheory.ae (Î¼.restrict (Set.uIoc a b)))\nâŠ¢ HasFDerivAt (fun x => intervalIntegral (fun t => F x t) a b Î¼) (intervalIntegral (fun t => F' xâ‚€ t) a b Î¼) xâ‚€","decl":"/-- Differentiation under integral of `x â†¦ âˆ« x in a..b, F x a` at a given point `xâ‚€`, assuming\n`F xâ‚€` is integrable on `(a,b)`, `x â†¦ F x a` is differentiable on a ball around `xâ‚€` for ae `a` with\nderivative norm uniformly bounded by an integrable function (the ball radius is independent of `a`),\nand `F x` is ae-measurable for `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasFDerivAt_integral_of_dominated_of_fderiv_le'' [NormedSpace â„ H] {Î¼ : Measure â„}\n    {F : H â†’ â„ â†’ E} {F' : H â†’ â„ â†’ H â†’L[â„] E} {a b : â„} {bound : â„ â†’ â„} (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) <| Î¼.restrict (Î™ a b))\n    (hF_int : IntervalIntegrable (F xâ‚€) Î¼ a b)\n    (hF'_meas : AEStronglyMeasurable (F' xâ‚€) <| Î¼.restrict (Î™ a b))\n    (h_bound : âˆ€áµ t âˆ‚Î¼.restrict (Î™ a b), âˆ€ x âˆˆ ball xâ‚€ Îµ, â€–F' x tâ€– â‰¤ bound t)\n    (bound_integrable : IntervalIntegrable bound Î¼ a b)\n    (h_diff : âˆ€áµ t âˆ‚Î¼.restrict (Î™ a b), âˆ€ x âˆˆ ball xâ‚€ Îµ, HasFDerivAt (F Â· t) (F' x t) x) :\n    HasFDerivAt (fun x â†¦ âˆ« t in a..b, F x t âˆ‚Î¼) (âˆ« t in a..b, F' xâ‚€ t âˆ‚Î¼) xâ‚€ := by\n  rw [ae_restrict_uIoc_iff] at h_diff h_bound\n  simp_rw [AEStronglyMeasurable.aestronglyMeasurable_uIoc_iff, eventually_and] at hF_meas hF'_meas\n  exact\n    (hasFDerivAt_integral_of_dominated_of_fderiv_le Îµ_pos hF_meas.1 hF_int.1 hF'_meas.1 h_bound.1\n          bound_integrable.1 h_diff.1).sub\n      (hasFDerivAt_integral_of_dominated_of_fderiv_le Îµ_pos hF_meas.2 hF_int.2 hF'_meas.2 h_bound.2\n        bound_integrable.2 h_diff.2)\n\n"}
{"name":"hasDerivAt_integral_of_dominated_loc_of_lip","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"Î± : Type u_1\ninstâœâ´ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\nğ•œ : Type u_2\ninstâœÂ³ : RCLike ğ•œ\nE : Type u_3\ninstâœÂ² : NormedAddCommGroup E\ninstâœÂ¹ : NormedSpace Real E\ninstâœ : NormedSpace ğ•œ E\nbound : Î± â†’ Real\nÎµ : Real\nF : ğ•œ â†’ Î± â†’ E\nxâ‚€ : ğ•œ\nF' : Î± â†’ E\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) Î¼) (nhds xâ‚€)\nhF_int : MeasureTheory.Integrable (F xâ‚€) Î¼\nhF'_meas : MeasureTheory.AEStronglyMeasurable F' Î¼\nh_lipsch : Filter.Eventually (fun a => LipschitzOnWith (Real.nnabs (bound a)) (fun x => F x a) (Metric.ball xâ‚€ Îµ)) (MeasureTheory.ae Î¼)\nbound_integrable : MeasureTheory.Integrable bound Î¼\nh_diff : Filter.Eventually (fun a => HasDerivAt (fun x => F x a) (F' a) xâ‚€) (MeasureTheory.ae Î¼)\nâŠ¢ And (MeasureTheory.Integrable F' Î¼) (HasDerivAt (fun x => MeasureTheory.integral Î¼ fun a => F x a) (MeasureTheory.integral Î¼ fun a => F' a) xâ‚€)","decl":"/-- Derivative under integral of `x â†¦ âˆ« F x a` at a given point `xâ‚€ : ğ•œ`, `ğ•œ = â„` or `ğ•œ = â„‚`,\nassuming `F xâ‚€` is integrable, `x â†¦ F x a` is locally Lipschitz on a ball around `xâ‚€` for ae `a`\n(with ball radius independent of `a`) with integrable Lipschitz bound, and `F x` is\nae-measurable for `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasDerivAt_integral_of_dominated_loc_of_lip {F' : Î± â†’ E} (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) Î¼) (hF_int : Integrable (F xâ‚€) Î¼)\n    (hF'_meas : AEStronglyMeasurable F' Î¼)\n    (h_lipsch : âˆ€áµ a âˆ‚Î¼, LipschitzOnWith (Real.nnabs <| bound a) (F Â· a) (ball xâ‚€ Îµ))\n    (bound_integrable : Integrable (bound : Î± â†’ â„) Î¼)\n    (h_diff : âˆ€áµ a âˆ‚Î¼, HasDerivAt (F Â· a) (F' a) xâ‚€) :\n    Integrable F' Î¼ âˆ§ HasDerivAt (fun x â†¦ âˆ« a, F x a âˆ‚Î¼) (âˆ« a, F' a âˆ‚Î¼) xâ‚€ := by\n  set L : E â†’L[ğ•œ] ğ•œ â†’L[ğ•œ] E := ContinuousLinearMap.smulRightL ğ•œ ğ•œ E 1\n  replace h_diff : âˆ€áµ a âˆ‚Î¼, HasFDerivAt (F Â· a) (L (F' a)) xâ‚€ :=\n    h_diff.mono fun x hx â†¦ hx.hasFDerivAt\n  have hm : AEStronglyMeasurable (L âˆ˜ F') Î¼ := L.continuous.comp_aestronglyMeasurable hF'_meas\n  cases'\n    hasFDerivAt_integral_of_dominated_loc_of_lip Îµ_pos hF_meas hF_int hm h_lipsch bound_integrable\n      h_diff with\n    hF'_int key\n  replace hF'_int : Integrable F' Î¼ := by\n    rw [â† integrable_norm_iff hm] at hF'_int\n    simpa only [L, (Â· âˆ˜ Â·), integrable_norm_iff, hF'_meas, one_mul, norm_one,\n      ContinuousLinearMap.comp_apply, ContinuousLinearMap.coe_restrict_scalarsL',\n      ContinuousLinearMap.norm_restrictScalars, ContinuousLinearMap.norm_smulRightL_apply] using\n      hF'_int\n  refine âŸ¨hF'_int, ?_âŸ©\n  by_cases hE : CompleteSpace E; swap\n  Â· simpa [integral, hE] using hasDerivAt_const xâ‚€ 0\n  simp_rw [hasDerivAt_iff_hasFDerivAt] at h_diff âŠ¢\n  simpa only [(Â· âˆ˜ Â·), ContinuousLinearMap.integral_comp_comm _ hF'_int] using key\n\n"}
{"name":"hasDerivAt_integral_of_dominated_loc_of_deriv_le","module":"Mathlib.Analysis.Calculus.ParametricIntegral","initialProofState":"Î± : Type u_1\ninstâœâ´ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\nğ•œ : Type u_2\ninstâœÂ³ : RCLike ğ•œ\nE : Type u_3\ninstâœÂ² : NormedAddCommGroup E\ninstâœÂ¹ : NormedSpace Real E\ninstâœ : NormedSpace ğ•œ E\nbound : Î± â†’ Real\nÎµ : Real\nF : ğ•œ â†’ Î± â†’ E\nxâ‚€ : ğ•œ\nÎµ_pos : LT.lt 0 Îµ\nhF_meas : Filter.Eventually (fun x => MeasureTheory.AEStronglyMeasurable (F x) Î¼) (nhds xâ‚€)\nhF_int : MeasureTheory.Integrable (F xâ‚€) Î¼\nF' : ğ•œ â†’ Î± â†’ E\nhF'_meas : MeasureTheory.AEStronglyMeasurable (F' xâ‚€) Î¼\nh_bound : Filter.Eventually (fun a => âˆ€ (x : ğ•œ), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ LE.le (Norm.norm (F' x a)) (bound a)) (MeasureTheory.ae Î¼)\nbound_integrable : MeasureTheory.Integrable bound Î¼\nh_diff : Filter.Eventually (fun a => âˆ€ (x : ğ•œ), Membership.mem (Metric.ball xâ‚€ Îµ) x â†’ HasDerivAt (fun x => F x a) (F' x a) x) (MeasureTheory.ae Î¼)\nâŠ¢ And (MeasureTheory.Integrable (F' xâ‚€) Î¼) (HasDerivAt (fun n => MeasureTheory.integral Î¼ fun a => F n a) (MeasureTheory.integral Î¼ fun a => F' xâ‚€ a) xâ‚€)","decl":"/-- Derivative under integral of `x â†¦ âˆ« F x a` at a given point `xâ‚€ : â„`, assuming\n`F xâ‚€` is integrable, `x â†¦ F x a` is differentiable on an interval around `xâ‚€` for ae `a`\n(with interval radius independent of `a`) with derivative uniformly bounded by an integrable\nfunction, and `F x` is ae-measurable for `x` in a possibly smaller neighborhood of `xâ‚€`. -/\ntheorem hasDerivAt_integral_of_dominated_loc_of_deriv_le (Îµ_pos : 0 < Îµ)\n    (hF_meas : âˆ€á¶  x in ğ“ xâ‚€, AEStronglyMeasurable (F x) Î¼) (hF_int : Integrable (F xâ‚€) Î¼)\n    {F' : ğ•œ â†’ Î± â†’ E} (hF'_meas : AEStronglyMeasurable (F' xâ‚€) Î¼)\n    (h_bound : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, â€–F' x aâ€– â‰¤ bound a) (bound_integrable : Integrable bound Î¼)\n    (h_diff : âˆ€áµ a âˆ‚Î¼, âˆ€ x âˆˆ ball xâ‚€ Îµ, HasDerivAt (F Â· a) (F' x a) x) :\n    Integrable (F' xâ‚€) Î¼ âˆ§ HasDerivAt (fun n â†¦ âˆ« a, F n a âˆ‚Î¼) (âˆ« a, F' xâ‚€ a âˆ‚Î¼) xâ‚€ := by\n  have xâ‚€_in : xâ‚€ âˆˆ ball xâ‚€ Îµ := mem_ball_self Îµ_pos\n  have diff_xâ‚€ : âˆ€áµ a âˆ‚Î¼, HasDerivAt (F Â· a) (F' xâ‚€ a) xâ‚€ :=\n    h_diff.mono fun a ha â†¦ ha xâ‚€ xâ‚€_in\n  have : âˆ€áµ a âˆ‚Î¼, LipschitzOnWith (Real.nnabs (bound a)) (fun x : ğ•œ â†¦ F x a) (ball xâ‚€ Îµ) := by\n    apply (h_diff.and h_bound).mono\n    rintro a âŸ¨ha_deriv, ha_boundâŸ©\n    refine (convex_ball _ _).lipschitzOnWith_of_nnnorm_hasDerivWithin_le\n      (fun x x_in â†¦ (ha_deriv x x_in).hasDerivWithinAt) fun x x_in â†¦ ?_\n    rw [â† NNReal.coe_le_coe, coe_nnnorm, Real.coe_nnabs]\n    exact (ha_bound x x_in).trans (le_abs_self _)\n  exact\n    hasDerivAt_integral_of_dominated_loc_of_lip Îµ_pos hF_meas hF_int hF'_meas this bound_integrable\n      diff_xâ‚€\n\n"}
