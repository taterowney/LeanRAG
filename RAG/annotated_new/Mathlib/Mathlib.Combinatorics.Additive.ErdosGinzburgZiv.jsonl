{"name":"Int.erdos_ginzburg_ziv","module":"Mathlib.Combinatorics.Additive.ErdosGinzburgZiv","initialProofState":"Î¹ : Type u_1\nn : Nat\ns : Finset Î¹\na : Î¹ â†’ Int\nhs : LE.le (HSub.hSub (HMul.hMul 2 n) 1) s.card\nâŠ¢ Exists fun t => And (HasSubset.Subset t s) (And (Eq t.card n) (Dvd.dvd (â†‘n) (t.sum fun i => a i)))","decl":"/-- The **ErdÅ‘sâ€“Ginzburgâ€“Ziv theorem** for `â„¤`.\n\nAny sequence of at least `2 * n - 1` elements of `â„¤` contains a subsequence of `n` elements whose\nsum is divisible by `n`. -/\ntheorem Int.erdos_ginzburg_ziv (a : Î¹ â†’ â„¤) (hs : 2 * n - 1 â‰¤ #s) :\n    âˆƒ t âŠ† s, #t = n âˆ§ â†‘n âˆ£ âˆ‘ i âˆˆ t, a i := by\n  classical\n  -- Do induction on the prime factorisation of `n`. Note that we will apply the induction\n  -- hypothesis with `Î¹ := Finset Î¹`, so we need to generalise.\n  induction n using Nat.prime_composite_induction generalizing Î¹ with\n  -- When `n := 0`, we can set `t := âˆ…`.\n  | zero => exact âŸ¨âˆ…, by simpâŸ©\n  -- When `n := 1`, we can take `t` to be any subset of `s` of size `2 * n - 1`.\n  | one => simpa using exists_subset_card_eq hs\n  -- When `n := p` is prime, we use the prime case `Int.erdos_ginzburg_ziv_prime`.\n  | prime p hp =>\n    haveI := Fact.mk hp\n    obtain âŸ¨t, hts, htâŸ© := exists_subset_card_eq hs\n    obtain âŸ¨u, hut, huâŸ© := Int.erdos_ginzburg_ziv_prime a ht\n    exact âŸ¨u, hut.trans hts, huâŸ©\n  -- When `n := m * n` is composite, we pick (by induction hypothesis on `n`) `2 * m - 1` sets of\n  -- size `n` and sums divisible by `n`. Then by induction hypothesis (on `m`) we can pick `m` of\n  -- these sets whose sum is divisible by `m * n`.\n  | composite m hm ihm n hn ihn =>\n     -- First, show that it is enough to have those `2 * m - 1` sets.\n    suffices âˆ€ k â‰¤ 2 * m - 1, âˆƒ ğ’œ : Finset (Finset Î¹), #ğ’œ = k âˆ§\n      (ğ’œ : Set (Finset Î¹)).Pairwise _root_.Disjoint âˆ§\n        âˆ€ â¦ƒtâ¦„, t âˆˆ ğ’œ â†’ t âŠ† s âˆ§ #t = n âˆ§ â†‘n âˆ£ âˆ‘ i âˆˆ t, a i by\n     -- Assume `ğ’œ` is a family of `2 * m - 1` sets, each of size `n` and sum divisible by `n`.\n      obtain âŸ¨ğ’œ, hğ’œcard, hğ’œdisj, hğ’œâŸ© := this _ le_rfl\n      -- By induction hypothesis on `m`, find a subfamily `â„¬` of size `m` such that the sum over\n      -- `t âˆˆ â„¬` of `(âˆ‘ i âˆˆ t, a i) / n` is divisible by `m`.\n      obtain âŸ¨â„¬, hâ„¬ğ’œ, hâ„¬card, hâ„¬âŸ© := ihm (fun t â†¦ (âˆ‘ i âˆˆ t, a i) / n) hğ’œcard.ge\n      -- We are done.\n      refine âŸ¨â„¬.biUnion fun x â†¦ x, biUnion_subset.2 fun t ht â†¦ (hğ’œ <| hâ„¬ğ’œ ht).1, ?_, ?_âŸ©\n      Â· rw [card_biUnion (hğ’œdisj.mono hâ„¬ğ’œ), sum_const_nat fun t ht â†¦ (hğ’œ <| hâ„¬ğ’œ ht).2.1, hâ„¬card]\n      rwa [sum_biUnion, natCast_mul, mul_comm, â† Int.dvd_div_iff_mul_dvd, Int.sum_div]\n      Â· exact fun t ht â†¦ (hğ’œ <| hâ„¬ğ’œ ht).2.2\n      Â· exact dvd_sum fun t ht â†¦ (hğ’œ <| hâ„¬ğ’œ ht).2.2\n      Â· exact hğ’œdisj.mono hâ„¬ğ’œ\n    -- Now, let's find those `2 * m - 1` sets.\n    rintro k hk\n    -- We induct on the size `k â‰¤ 2 * m - 1` of the family we are constructing.\n    induction' k with k ih\n    -- For `k = 0`, the empty family trivially works.\n    Â· exact âŸ¨âˆ…, by simpâŸ©\n    -- At `k + 1`, call `ğ’œ` the existing family of size `k â‰¤ 2 * m - 2`.\n    obtain âŸ¨ğ’œ, hğ’œcard, hğ’œdisj, hğ’œâŸ© := ih (Nat.le_of_succ_le hk)\n    -- There are at least `2 * (m * n) - 1 - k * n â‰¥ 2 * m - 1` elements in `s` that have not been\n    -- taken in any element of `ğ’œ`.\n    have : 2 * n - 1 â‰¤ #(s \\ ğ’œ.biUnion id) := by\n      calc\n        _ â‰¤ (2 * m - k) * n - 1 := by gcongr; omega\n        _ = (2 * (m * n) - 1) - âˆ‘ t âˆˆ ğ’œ, #t := by\n          rw [tsub_mul, mul_assoc, tsub_right_comm, sum_const_nat fun t ht â†¦ (hğ’œ ht).2.1, hğ’œcard]\n        _ â‰¤ #s - #(ğ’œ.biUnion id) := by gcongr; exact card_biUnion_le\n        _ â‰¤ #(s \\ ğ’œ.biUnion id) := le_card_sdiff ..\n    -- So by the induction hypothesis on `n` we can find a new set `t` of size `n` and sum divisible\n    -- by `n`.\n    obtain âŸ¨tâ‚€, htâ‚€, htâ‚€card, htâ‚€sumâŸ© := ihn a this\n    -- This set is distinct and disjoint from the previous ones, so we are done.\n    have : tâ‚€ âˆ‰ ğ’œ := by\n      rintro h\n      obtain rfl : n = 0 := by\n        simpa [â† card_eq_zero, htâ‚€card] using sdiff_disjoint.mono htâ‚€ <| subset_biUnion_of_mem id h\n      omega\n    refine âŸ¨ğ’œ.cons tâ‚€ this, by rw [card_cons, hğ’œcard], ?_, ?_âŸ©\n    Â· simp only [cons_eq_insert, coe_insert, Set.pairwise_insert_of_symmetric symmetric_disjoint,\n        mem_coe, ne_eq]\n      exact âŸ¨hğ’œdisj, fun t ht _ â†¦ sdiff_disjoint.mono htâ‚€ <| subset_biUnion_of_mem id htâŸ©\n    Â· simp only [cons_eq_insert, mem_insert, forall_eq_or_imp, and_assoc]\n      exact âŸ¨htâ‚€.trans sdiff_subset, htâ‚€card, htâ‚€sum, hğ’œâŸ©\n\n"}
{"name":"ZMod.erdos_ginzburg_ziv","module":"Mathlib.Combinatorics.Additive.ErdosGinzburgZiv","initialProofState":"Î¹ : Type u_1\nn : Nat\ns : Finset Î¹\na : Î¹ â†’ ZMod n\nhs : LE.le (HSub.hSub (HMul.hMul 2 n) 1) s.card\nâŠ¢ Exists fun t => And (HasSubset.Subset t s) (And (Eq t.card n) (Eq (t.sum fun i => a i) 0))","decl":"/-- The **ErdÅ‘sâ€“Ginzburgâ€“Ziv theorem** for `â„¤/nâ„¤`.\n\nAny sequence of at least `2 * n - 1` elements of `ZMod n` contains a subsequence of `n` elements\nwhose sum is zero. -/\ntheorem ZMod.erdos_ginzburg_ziv (a : Î¹ â†’ ZMod n) (hs : 2 * n - 1 â‰¤ #s) :\n    âˆƒ t âŠ† s, #t = n âˆ§ âˆ‘ i âˆˆ t, a i = 0 := by\n  simpa [â† ZMod.intCast_zmod_eq_zero_iff_dvd] using Int.erdos_ginzburg_ziv (ZMod.cast âˆ˜ a) hs\n\n"}
{"name":"Int.erdos_ginzburg_ziv_multiset","module":"Mathlib.Combinatorics.Additive.ErdosGinzburgZiv","initialProofState":"n : Nat\ns : Multiset Int\nhs : LE.le (HSub.hSub (HMul.hMul 2 n) 1) s.card\nâŠ¢ Exists fun t => And (LE.le t s) (And (Eq t.card n) (Dvd.dvd (â†‘n) t.sum))","decl":"/-- The **ErdÅ‘sâ€“Ginzburgâ€“Ziv theorem** for `â„¤` for multiset.\n\nAny multiset of at least `2 * n - 1` elements of `â„¤` contains a submultiset of `n` elements whose\nsum is divisible by `n`. -/\ntheorem Int.erdos_ginzburg_ziv_multiset (s : Multiset â„¤) (hs : 2 * n - 1 â‰¤ Multiset.card s) :\n    âˆƒ t â‰¤ s, Multiset.card t = n âˆ§ â†‘n âˆ£ t.sum := by\n  obtain âŸ¨t, hts, htâŸ© := Int.erdos_ginzburg_ziv (s := s.toEnumFinset) Prod.fst (by simpa using hs)\n  exact âŸ¨t.1.map Prod.fst, Multiset.map_fst_le_of_subset_toEnumFinset hts, by simpa using htâŸ©\n\n"}
{"name":"ZMod.erdos_ginzburg_ziv_multiset","module":"Mathlib.Combinatorics.Additive.ErdosGinzburgZiv","initialProofState":"n : Nat\ns : Multiset (ZMod n)\nhs : LE.le (HSub.hSub (HMul.hMul 2 n) 1) s.card\nâŠ¢ Exists fun t => And (LE.le t s) (And (Eq t.card n) (Eq t.sum 0))","decl":"/-- The **ErdÅ‘sâ€“Ginzburgâ€“Ziv theorem** for `â„¤/nâ„¤` for multiset.\n\nAny multiset of at least `2 * n - 1` elements of `â„¤` contains a submultiset of `n` elements whose\nsum is divisible by `n`. -/\ntheorem ZMod.erdos_ginzburg_ziv_multiset (s : Multiset (ZMod n))\n    (hs : 2 * n - 1 â‰¤ Multiset.card s) : âˆƒ t â‰¤ s, Multiset.card t = n âˆ§ t.sum = 0 := by\n  obtain âŸ¨t, hts, htâŸ© := ZMod.erdos_ginzburg_ziv (s := s.toEnumFinset) Prod.fst (by simpa using hs)\n  exact âŸ¨t.1.map Prod.fst, Multiset.map_fst_le_of_subset_toEnumFinset hts, by simpa using htâŸ©\n\n"}
