{"name":"MeasureTheory.tendsto_measure_symmDiff_preimage_nhds_zero","module":"Mathlib.MeasureTheory.Measure.ContinuousPreimage","initialProofState":"Î± : Type u_1\nX : Type u_2\nY : Type u_3\ninstâœâ¹ : TopologicalSpace X\ninstâœâ¸ : MeasurableSpace X\ninstâœâ· : BorelSpace X\ninstâœâ¶ : R1Space X\ninstâœâµ : TopologicalSpace Y\ninstâœâ´ : MeasurableSpace Y\ninstâœÂ³ : BorelSpace Y\ninstâœÂ² : R1Space Y\nÎ¼ : MeasureTheory.Measure X\nÎ½ : MeasureTheory.Measure Y\ninstâœÂ¹ : Î¼.InnerRegularCompactLTTop\ninstâœ : MeasureTheory.IsLocallyFiniteMeasure Î½\nl : Filter Î±\nf : Î± â†’ ContinuousMap X Y\ng : ContinuousMap X Y\ns : Set Y\nhfg : Filter.Tendsto f l (nhds g)\nhf : Filter.Eventually (fun a => MeasureTheory.MeasurePreserving (â‡‘(f a)) Î¼ Î½) l\nhg : MeasureTheory.MeasurePreserving (â‡‘g) Î¼ Î½\nhs : MeasureTheory.NullMeasurableSet s Î½\nhÎ½s : Ne (Î½ s) Top.top\nâŠ¢ Filter.Tendsto (fun a => Î¼ (symmDiff (Set.preimage (â‡‘(f a)) s) (Set.preimage (â‡‘g) s))) l (nhds 0)","decl":"/-- Let `X` and `Y` be Râ‚ topological spaces\nwith Borel Ïƒ-algebras and measures `Î¼` and `Î½`, respectively.\nSuppose that `Î¼` is inner regular for finite measure sets with respect to compact sets\nand `Î½` is a locally finite measure.\nLet `f : Î± â†’ C(X, Y)` be a family of continuous maps\nthat converges to a continuous map `g : C(X, Y)` in the compact-open topology along a filter `l`.\nSuppose that `g` is a measure preserving map\nand `f a` is a measure preserving map eventually along `l`.\nThen for any finite measure measurable set `s`,\nthe preimages `f a â»Â¹' s` tend to the preimage `g â»Â¹' s` in measure.\nMore precisely, the measure of the symmetric difference of these two sets tends to zero. -/\ntheorem tendsto_measure_symmDiff_preimage_nhds_zero\n    {l : Filter Î±} {f : Î± â†’ C(X, Y)} {g : C(X, Y)} {s : Set Y} (hfg : Tendsto f l (ğ“ g))\n    (hf : âˆ€á¶  a in l, MeasurePreserving (f a) Î¼ Î½) (hg : MeasurePreserving g Î¼ Î½)\n    (hs : NullMeasurableSet s Î½) (hÎ½s : Î½ s â‰  âˆ) :\n    Tendsto (fun a â†¦ Î¼ ((f a â»Â¹' s) âˆ† (g â»Â¹' s))) l (ğ“ 0) := by\n  have : Î½.InnerRegularCompactLTTop := by\n    rw [â† hg.map_eq]\n    exact .map_of_continuous (map_continuous _)\n  rw [ENNReal.tendsto_nhds_zero]\n  intro Îµ hÎµ\n  -- Without loss of generality, `s` is an open set.\n  wlog hso : IsOpen s generalizing s Îµ\n  Â· have H : 0 < Îµ / 3 := ENNReal.div_pos hÎµ.ne' ENNReal.coe_ne_top\n    -- Indeed, we can choose an open set `U` such that `Î½ (U âˆ† s) < Îµ / 3`,\n    -- apply the lemma to `U`, then use the triangle inequality for `Î¼ (_ âˆ† _)`.\n    rcases hs.exists_isOpen_symmDiff_lt hÎ½s H.ne' with âŸ¨U, hUo, hU, hUsâŸ©\n    have hmU : NullMeasurableSet U Î½ := hUo.measurableSet.nullMeasurableSet\n    replace hUs := hUs.le\n    filter_upwards [hf, this hmU hU.ne _ H hUo] with a hfa ha\n    calc\n      Î¼ ((f a â»Â¹' s) âˆ† (g â»Â¹' s))\n        â‰¤ Î¼ ((f a â»Â¹' s) âˆ† (f a â»Â¹' U)) + Î¼ ((f a â»Â¹' U) âˆ† (g â»Â¹' U))\n          + Î¼ ((g â»Â¹' U) âˆ† (g â»Â¹' s)) := by\n        refine (measure_symmDiff_le _ (g â»Â¹' U) _).trans ?_\n        gcongr\n        apply measure_symmDiff_le\n      _ â‰¤ Îµ / 3 + Îµ / 3 + Îµ / 3 := by\n        gcongr\n        Â· rwa [â† preimage_symmDiff, hfa.measure_preimage (hs.symmDiff hmU), symmDiff_comm]\n        Â· rwa [â† preimage_symmDiff, hg.measure_preimage (hmU.symmDiff hs)]\n      _ = Îµ := by simp\n  -- Take a compact closed subset `K âŠ† g â»Â¹' s` of almost full measure,\n  -- `Î¼ (g â»Â¹' s \\ K) < Îµ / 2`.\n  have hÎ½s' : Î¼ (g â»Â¹' s) â‰  âˆ := by rwa [hg.measure_preimage hs]\n  obtain âŸ¨K, hKg, hKco, hKcl, hKÎ¼âŸ© :\n      âˆƒ K, MapsTo g K s âˆ§ IsCompact K âˆ§ IsClosed K âˆ§ Î¼ (g â»Â¹' s \\ K) < Îµ / 2 :=\n    (hg.measurable hso.measurableSet).exists_isCompact_isClosed_diff_lt hÎ½s' <| by simp [hÎµ.ne']\n  have hKm : NullMeasurableSet K Î¼ := hKcl.nullMeasurableSet\n  -- Take `a` such that `f a` is measure preserving and maps `K` to `s`.\n  -- This is possible, because `K` is a compact set and `s` is an open set.\n  filter_upwards [hf, ContinuousMap.tendsto_nhds_compactOpen.mp hfg K hKco s hso hKg] with a hfa ha\n  -- Then each of the sets `g â»Â¹' s âˆ† K = g â»Â¹' s \\ K` and `f a â»Â¹' s âˆ† K = f a â»Â¹' s \\ K`\n  -- have measure at most `Îµ / 2`, thus `f a â»Â¹' s âˆ† g â»Â¹' s` has measure at most `Îµ`.\n  rw [â† ENNReal.add_halves Îµ]\n  refine (measure_symmDiff_le _ K _).trans ?_\n  rw [symmDiff_of_ge ha.subset_preimage, symmDiff_of_le hKg.subset_preimage]\n  gcongr\n  have hK' : Î¼ K â‰  âˆ := ne_top_of_le_ne_top hÎ½s' <| measure_mono hKg.subset_preimage\n  rw [measure_diff_le_iff_le_add hKm ha.subset_preimage hK', hfa.measure_preimage hs,\n    â† hg.measure_preimage hs, â† measure_diff_le_iff_le_add hKm hKg.subset_preimage hK']\n  exact hKÎ¼.le\n\n"}
{"name":"MeasureTheory.isClosed_setOf_preimage_ae_eq","module":"Mathlib.MeasureTheory.Measure.ContinuousPreimage","initialProofState":"X : Type u_2\nY : Type u_3\nZ : Type u_4\ninstâœÂ¹â° : TopologicalSpace X\ninstâœâ¹ : MeasurableSpace X\ninstâœâ¸ : BorelSpace X\ninstâœâ· : R1Space X\ninstâœâ¶ : TopologicalSpace Y\ninstâœâµ : MeasurableSpace Y\ninstâœâ´ : BorelSpace Y\ninstâœÂ³ : R1Space Y\ninstâœÂ² : TopologicalSpace Z\nÎ¼ : MeasureTheory.Measure X\nÎ½ : MeasureTheory.Measure Y\ninstâœÂ¹ : Î¼.InnerRegularCompactLTTop\ninstâœ : MeasureTheory.IsLocallyFiniteMeasure Î½\nf : Z â†’ ContinuousMap X Y\nhf : Continuous f\nhfm : âˆ€ (z : Z), MeasureTheory.MeasurePreserving (â‡‘(f z)) Î¼ Î½\ns : Set X\nt : Set Y\nhtm : MeasureTheory.NullMeasurableSet t Î½\nht : Ne (Î½ t) Top.top\nâŠ¢ IsClosed (setOf fun z => (MeasureTheory.ae Î¼).EventuallyEq (Set.preimage (â‡‘(f z)) t) s)","decl":"/-- Let `f : Z â†’ C(X, Y)` be a continuous (in the compact open topology) family\nof continuous measure preserving maps.\nLet `t : Set Y` be a null measurable set of finite measure.\nThen for any `s`, the set of parameters `z`\nsuch that the preimage of `t` under `f_z` is a.e. equal to `s`\nis a closed set.\n\nIn particular, if `X = Y` and `s = t`,\nthen we see that the a.e. stabilizer of a set is a closed set. -/\ntheorem isClosed_setOf_preimage_ae_eq {f : Z â†’ C(X, Y)} (hf : Continuous f)\n    (hfm : âˆ€ z, MeasurePreserving (f z) Î¼ Î½) (s : Set X)\n    {t : Set Y} (htm : NullMeasurableSet t Î½) (ht : Î½ t â‰  âˆ) :\n    IsClosed {z | f z â»Â¹' t =áµ[Î¼] s} := by\n  rw [â† isOpen_compl_iff, isOpen_iff_mem_nhds]\n  intro z hz\n  replace hz : âˆ€á¶  Îµ : â„â‰¥0âˆ in ğ“ 0, Îµ < Î¼ ((f z â»Â¹' t) âˆ† s) := by\n    apply gt_mem_nhds\n    rwa [pos_iff_ne_zero, ne_eq, measure_symmDiff_eq_zero_iff]\n  filter_upwards [(tendsto_measure_symmDiff_preimage_nhds_zero (hf.tendsto z)\n    (.of_forall hfm) (hfm z) htm ht).eventually hz] with w hw\n  intro (hw' : f w â»Â¹' t =áµ[Î¼] s)\n  rw [measure_congr (hw'.symmDiff (ae_eq_refl _)), symmDiff_comm] at hw\n  exact hw.false\n\n"}
