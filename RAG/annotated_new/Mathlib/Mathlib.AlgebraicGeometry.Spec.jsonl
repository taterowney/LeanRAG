{"name":"AlgebraicGeometry.Spec.topObj_forget","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq ((CategoryTheory.forget TopCat).obj (AlgebraicGeometry.Spec.topObj R)) (PrimeSpectrum ‚ÜëR)","decl":"@[simp] theorem Spec.topObj_forget {R} : (forget TopCat).obj (Spec.topObj R) = PrimeSpectrum R :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.topMap_id","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.topMap (CategoryTheory.CategoryStruct.id R)) (CategoryTheory.CategoryStruct.id (AlgebraicGeometry.Spec.topObj R))","decl":"@[simp]\ntheorem Spec.topMap_id (R : CommRingCat.{u}) : Spec.topMap (ùüô R) = ùüô (Spec.topObj R) :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.topMap_comp","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S T : CommRingCat\nf : Quiver.Hom R S\ng : Quiver.Hom S T\n‚ä¢ Eq (AlgebraicGeometry.Spec.topMap (CategoryTheory.CategoryStruct.comp f g)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.Spec.topMap g) (AlgebraicGeometry.Spec.topMap f))","decl":"@[simp]\ntheorem Spec.topMap_comp {R S T : CommRingCat.{u}} (f : R ‚ü∂ S) (g : S ‚ü∂ T) :\n    Spec.topMap (f ‚â´ g) = Spec.topMap g ‚â´ Spec.topMap f :=\n  rfl\n\n-- Porting note: `simps!` generate some garbage lemmas, so choose manually,\n-- if more is needed, add them here\n"}
{"name":"AlgebraicGeometry.Spec.toTop_obj_Œ±","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Opposite CommRingCat\n‚ä¢ Eq (‚Üë(AlgebraicGeometry.Spec.toTop.obj R)) (PrimeSpectrum ‚Üë(Opposite.unop R))","decl":"/-- The spectrum, as a contravariant functor from commutative rings to topological spaces.\n-/\n@[simps!]\ndef Spec.toTop : CommRingCat.{u}·µí·µñ ‚•§ TopCat where\n  obj R := Spec.topObj (unop R)\n  map {_ _} f := Spec.topMap f.unop\n\n"}
{"name":"AlgebraicGeometry.Spec.toTop_obj_str_IsOpen","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Opposite CommRingCat\nX : Set (PrimeSpectrum ‚Üë(Opposite.unop R))\n‚ä¢ Eq (TopologicalSpace.IsOpen X) (Exists fun y => Eq (PrimeSpectrum.zeroLocus y) (HasCompl.compl X))","decl":"/-- The spectrum, as a contravariant functor from commutative rings to topological spaces.\n-/\n@[simps!]\ndef Spec.toTop : CommRingCat.{u}·µí·µñ ‚•§ TopCat where\n  obj R := Spec.topObj (unop R)\n  map {_ _} f := Spec.topMap f.unop\n\n"}
{"name":"AlgebraicGeometry.Spec.coe_toTop_map_apply_asIdeal","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"x‚úù¬π x‚úù : Opposite CommRingCat\nf : Quiver.Hom x‚úù¬π x‚úù\na‚úù : PrimeSpectrum ‚Üë(Opposite.unop x‚úù¬π)\n‚ä¢ Eq (‚Üë((AlgebraicGeometry.Spec.toTop.map f) a‚úù).asIdeal) (Set.preimage ‚áë(CommRingCat.Hom.hom f.unop) ‚Üëa‚úù.asIdeal)","decl":"/-- The spectrum, as a contravariant functor from commutative rings to topological spaces.\n-/\n@[simps!]\ndef Spec.toTop : CommRingCat.{u}·µí·µñ ‚•§ TopCat where\n  obj R := Spec.topObj (unop R)\n  map {_ _} f := Spec.topMap f.unop\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceObj_carrier","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (‚Üë(AlgebraicGeometry.Spec.sheafedSpaceObj R).toPresheafedSpace) (AlgebraicGeometry.Spec.topObj R)","decl":"/-- The spectrum of a commutative ring, as a `SheafedSpace`.\n-/\n@[simps]\ndef Spec.sheafedSpaceObj (R : CommRingCat.{u}) : SheafedSpace CommRingCat where\n  carrier := Spec.topObj R\n  presheaf := (structureSheaf R).1\n  IsSheaf := (structureSheaf R).2\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceObj_presheaf","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.sheafedSpaceObj R).presheaf (AlgebraicGeometry.Spec.structureSheaf ‚ÜëR).val","decl":"/-- The spectrum of a commutative ring, as a `SheafedSpace`.\n-/\n@[simps]\ndef Spec.sheafedSpaceObj (R : CommRingCat.{u}) : SheafedSpace CommRingCat where\n  carrier := Spec.topObj R\n  presheaf := (structureSheaf R).1\n  IsSheaf := (structureSheaf R).2\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceMap_c_app","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\nU : Opposite (TopologicalSpace.Opens ‚Üë‚Üë(AlgebraicGeometry.Spec.sheafedSpaceObj R).toPresheafedSpace)\n‚ä¢ Eq ((AlgebraicGeometry.Spec.sheafedSpaceMap f).c.app U) (CommRingCat.ofHom (AlgebraicGeometry.StructureSheaf.comap (CommRingCat.Hom.hom f) (Opposite.unop U) ((TopologicalSpace.Opens.map (AlgebraicGeometry.Spec.topMap f)).obj (Opposite.unop U)) ‚ãØ))","decl":"/-- The induced map of a ring homomorphism on the ring spectra, as a morphism of sheafed spaces.\n-/\n@[simps base c_app]\ndef Spec.sheafedSpaceMap {R S : CommRingCat.{u}} (f : R ‚ü∂ S) :\n    Spec.sheafedSpaceObj S ‚ü∂ Spec.sheafedSpaceObj R where\n  base := Spec.topMap f\n  c :=\n    { app := fun U => CommRingCat.ofHom <|\n        comap f.hom (unop U) ((TopologicalSpace.Opens.map (Spec.topMap f)).obj (unop U)) fun _ => id\n      naturality := fun {_ _} _ => by ext; rfl }\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceMap_base","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\n‚ä¢ Eq (AlgebraicGeometry.Spec.sheafedSpaceMap f).base (AlgebraicGeometry.Spec.topMap f)","decl":"/-- The induced map of a ring homomorphism on the ring spectra, as a morphism of sheafed spaces.\n-/\n@[simps base c_app]\ndef Spec.sheafedSpaceMap {R S : CommRingCat.{u}} (f : R ‚ü∂ S) :\n    Spec.sheafedSpaceObj S ‚ü∂ Spec.sheafedSpaceObj R where\n  base := Spec.topMap f\n  c :=\n    { app := fun U => CommRingCat.ofHom <|\n        comap f.hom (unop U) ((TopologicalSpace.Opens.map (Spec.topMap f)).obj (unop U)) fun _ => id\n      naturality := fun {_ _} _ => by ext; rfl }\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceMap_id","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.sheafedSpaceMap (CategoryTheory.CategoryStruct.id R)) (CategoryTheory.CategoryStruct.id (AlgebraicGeometry.Spec.sheafedSpaceObj R))","decl":"@[simp]\ntheorem Spec.sheafedSpaceMap_id {R : CommRingCat.{u}} :\n    Spec.sheafedSpaceMap (ùüô R) = ùüô (Spec.sheafedSpaceObj R) :=\n  AlgebraicGeometry.PresheafedSpace.Hom.ext _ _ (Spec.topMap_id R) <| by\n    ext\n    dsimp\n    rw [comap_id (by simp)]\n    simp\n    rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.sheafedSpaceMap_comp","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S T : CommRingCat\nf : Quiver.Hom R S\ng : Quiver.Hom S T\n‚ä¢ Eq (AlgebraicGeometry.Spec.sheafedSpaceMap (CategoryTheory.CategoryStruct.comp f g)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.Spec.sheafedSpaceMap g) (AlgebraicGeometry.Spec.sheafedSpaceMap f))","decl":"theorem Spec.sheafedSpaceMap_comp {R S T : CommRingCat.{u}} (f : R ‚ü∂ S) (g : S ‚ü∂ T) :\n    Spec.sheafedSpaceMap (f ‚â´ g) = Spec.sheafedSpaceMap g ‚â´ Spec.sheafedSpaceMap f :=\n  AlgebraicGeometry.PresheafedSpace.Hom.ext _ _ (Spec.topMap_comp f g) <| by\n    ext\n    -- Porting note: was one liner\n    -- `dsimp, rw category_theory.functor.map_id, rw category.comp_id, erw comap_comp f g, refl`\n    rw [NatTrans.comp_app, sheafedSpaceMap_c_app, whiskerRight_app, eqToHom_refl]\n    erw [(sheafedSpaceObj T).presheaf.map_id, Category.comp_id, comap_comp]\n    rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.toSheafedSpace_obj","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Opposite CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.toSheafedSpace.obj R) (AlgebraicGeometry.Spec.sheafedSpaceObj (Opposite.unop R))","decl":"/-- Spec, as a contravariant functor from commutative rings to sheafed spaces.\n-/\n@[simps]\ndef Spec.toSheafedSpace : CommRingCat.{u}·µí·µñ ‚•§ SheafedSpace CommRingCat where\n  obj R := Spec.sheafedSpaceObj (unop R)\n  map f := Spec.sheafedSpaceMap f.unop\n  map_comp f g := by simp [Spec.sheafedSpaceMap_comp]\n\n"}
{"name":"AlgebraicGeometry.Spec.toSheafedSpace_map","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"X‚úù Y‚úù : Opposite CommRingCat\nf : Quiver.Hom X‚úù Y‚úù\n‚ä¢ Eq (AlgebraicGeometry.Spec.toSheafedSpace.map f) (AlgebraicGeometry.Spec.sheafedSpaceMap f.unop)","decl":"/-- Spec, as a contravariant functor from commutative rings to sheafed spaces.\n-/\n@[simps]\ndef Spec.toSheafedSpace : CommRingCat.{u}·µí·µñ ‚•§ SheafedSpace CommRingCat where\n  obj R := Spec.sheafedSpaceObj (unop R)\n  map f := Spec.sheafedSpaceMap f.unop\n  map_comp f g := by simp [Spec.sheafedSpaceMap_comp]\n\n"}
{"name":"AlgebraicGeometry.Spec.toPresheafedSpace_obj","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Opposite CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.toPresheafedSpace.obj R) (AlgebraicGeometry.Spec.sheafedSpaceObj (Opposite.unop R)).toPresheafedSpace","decl":"@[simp]\ntheorem Spec.toPresheafedSpace_obj (R : CommRingCat.{u}·µí·µñ) :\n    Spec.toPresheafedSpace.obj R = (Spec.sheafedSpaceObj (unop R)).toPresheafedSpace :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.toPresheafedSpace_obj_op","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.toPresheafedSpace.obj { unop := R }) (AlgebraicGeometry.Spec.sheafedSpaceObj R).toPresheafedSpace","decl":"theorem Spec.toPresheafedSpace_obj_op (R : CommRingCat.{u}) :\n    Spec.toPresheafedSpace.obj (op R) = (Spec.sheafedSpaceObj R).toPresheafedSpace :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.toPresheafedSpace_map","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : Opposite CommRingCat\nf : Quiver.Hom R S\n‚ä¢ Eq (AlgebraicGeometry.Spec.toPresheafedSpace.map f) (AlgebraicGeometry.Spec.sheafedSpaceMap f.unop)","decl":"@[simp]\ntheorem Spec.toPresheafedSpace_map (R S : CommRingCat.{u}·µí·µñ) (f : R ‚ü∂ S) :\n    Spec.toPresheafedSpace.map f = Spec.sheafedSpaceMap f.unop :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.toPresheafedSpace_map_op","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\n‚ä¢ Eq (AlgebraicGeometry.Spec.toPresheafedSpace.map f.op) (AlgebraicGeometry.Spec.sheafedSpaceMap f)","decl":"theorem Spec.toPresheafedSpace_map_op (R S : CommRingCat.{u}) (f : R ‚ü∂ S) :\n    Spec.toPresheafedSpace.map f.op = Spec.sheafedSpaceMap f :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.basicOpen_hom_ext","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"X : AlgebraicGeometry.RingedSpace\nR : CommRingCat\nŒ± Œ≤ : Quiver.Hom X (AlgebraicGeometry.Spec.sheafedSpaceObj R)\nw : Eq Œ±.base Œ≤.base\nh :\n  ‚àÄ (r : ‚ÜëR),\n    let U := PrimeSpectrum.basicOpen r;\n    Eq (CategoryTheory.CategoryStruct.comp (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toOpen (‚ÜëR) U) (Œ±.c.app { unop := U })) (X.presheaf.map (CategoryTheory.eqToHom ‚ãØ))) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toOpen (‚ÜëR) U) (Œ≤.c.app { unop := U }))\n‚ä¢ Eq Œ± Œ≤","decl":"theorem Spec.basicOpen_hom_ext {X : RingedSpace.{u}} {R : CommRingCat.{u}}\n    {Œ± Œ≤ : X ‚ü∂ Spec.sheafedSpaceObj R} (w : Œ±.base = Œ≤.base)\n    (h : ‚àÄ r : R,\n      let U := PrimeSpectrum.basicOpen r\n      (toOpen R U ‚â´ Œ±.c.app (op U)) ‚â´ X.presheaf.map (eqToHom (by rw [w])) =\n        toOpen R U ‚â´ Œ≤.c.app (op U)) :\n    Œ± = Œ≤ := by\n  ext : 1\n  ¬∑ exact w\n  ¬∑ apply\n      ((TopCat.Sheaf.pushforward _ Œ≤.base).obj X.sheaf).hom_ext _ PrimeSpectrum.isBasis_basic_opens\n    intro r\n    apply (StructureSheaf.to_basicOpen_epi R r).1\n    simpa using h r\n\n-- Porting note: `simps!` generate some garbage lemmas, so choose manually,\n-- if more is needed, add them here\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_presheaf","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceObj R).presheaf (AlgebraicGeometry.Spec.structureSheaf ‚ÜëR).val","decl":"/-- The spectrum of a commutative ring, as a `LocallyRingedSpace`.\n-/\n@[simps! toSheafedSpace presheaf]\ndef Spec.locallyRingedSpaceObj (R : CommRingCat.{u}) : LocallyRingedSpace :=\n  { Spec.sheafedSpaceObj R with\n    isLocalRing := fun x =>\n      RingEquiv.isLocalRing (A := Localization.AtPrime x.asIdeal)\n        (Iso.commRingCatIsoToRingEquiv <| stalkIso R x).symm }\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_toSheafedSpace","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceObj R).toSheafedSpace (AlgebraicGeometry.Spec.sheafedSpaceObj R)","decl":"/-- The spectrum of a commutative ring, as a `LocallyRingedSpace`.\n-/\n@[simps! toSheafedSpace presheaf]\ndef Spec.locallyRingedSpaceObj (R : CommRingCat.{u}) : LocallyRingedSpace :=\n  { Spec.sheafedSpaceObj R with\n    isLocalRing := fun x =>\n      RingEquiv.isLocalRing (A := Localization.AtPrime x.asIdeal)\n        (Iso.commRingCatIsoToRingEquiv <| stalkIso R x).symm }\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_sheaf","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceObj R).sheaf (AlgebraicGeometry.Spec.structureSheaf ‚ÜëR)","decl":"lemma Spec.locallyRingedSpaceObj_sheaf (R : CommRingCat.{u}) :\n    (Spec.locallyRingedSpaceObj R).sheaf = structureSheaf R := rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_sheaf'","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Type u\ninst‚úù : CommRing R\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceObj (CommRingCat.of R)).sheaf (AlgebraicGeometry.Spec.structureSheaf R)","decl":"lemma Spec.locallyRingedSpaceObj_sheaf' (R : Type u) [CommRing R] :\n    (Spec.locallyRingedSpaceObj <| CommRingCat.of R).sheaf = structureSheaf R := rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_presheaf_map","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\nU V : Opposite (TopologicalSpace.Opens ‚Üë‚Üë(AlgebraicGeometry.Spec.locallyRingedSpaceObj R).toPresheafedSpace)\ni : Quiver.Hom U V\n‚ä¢ Eq ((AlgebraicGeometry.Spec.locallyRingedSpaceObj R).presheaf.map i) ((AlgebraicGeometry.Spec.structureSheaf ‚ÜëR).val.map i)","decl":"lemma Spec.locallyRingedSpaceObj_presheaf_map (R : CommRingCat.{u}) {U V} (i : U ‚ü∂ V) :\n    (Spec.locallyRingedSpaceObj R).presheaf.map i =\n    (structureSheaf R).1.map i := rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_presheaf'","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Type u\ninst‚úù : CommRing R\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceObj (CommRingCat.of R)).presheaf (AlgebraicGeometry.Spec.structureSheaf R).val","decl":"lemma Spec.locallyRingedSpaceObj_presheaf' (R : Type u) [CommRing R] :\n    (Spec.locallyRingedSpaceObj <| CommRingCat.of R).presheaf = (structureSheaf R).1 := rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceObj_presheaf_map'","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Type u\ninst‚úù : CommRing R\nU V : Opposite (TopologicalSpace.Opens ‚Üë‚Üë(AlgebraicGeometry.Spec.locallyRingedSpaceObj (CommRingCat.of R)).toPresheafedSpace)\ni : Quiver.Hom U V\n‚ä¢ Eq ((AlgebraicGeometry.Spec.locallyRingedSpaceObj (CommRingCat.of R)).presheaf.map i) ((AlgebraicGeometry.Spec.structureSheaf R).val.map i)","decl":"lemma Spec.locallyRingedSpaceObj_presheaf_map' (R : Type u) [CommRing R] {U V} (i : U ‚ü∂ V) :\n    (Spec.locallyRingedSpaceObj <| CommRingCat.of R).presheaf.map i =\n    (structureSheaf R).1.map i := rfl\n\n"}
{"name":"AlgebraicGeometry.stalkMap_toStalk","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëS\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëR) ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p)) (AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.sheafedSpaceMap f) p)) (CategoryTheory.CategoryStruct.comp f (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëS) p))","decl":"@[elementwise]\ntheorem stalkMap_toStalk {R S : CommRingCat.{u}} (f : R ‚ü∂ S) (p : PrimeSpectrum S) :\n    toStalk R (PrimeSpectrum.comap f.hom p) ‚â´ (Spec.sheafedSpaceMap f).stalkMap p =\n      f ‚â´ toStalk S p := by\n  rw [‚Üê toOpen_germ S ‚ä§ p trivial, ‚Üê toOpen_germ R ‚ä§ (PrimeSpectrum.comap f.hom p) trivial,\n    Category.assoc]\n  erw [PresheafedSpace.stalkMap_germ (Spec.sheafedSpaceMap f) ‚ä§ p trivial]\n  rw [Spec.sheafedSpaceMap_c_app]\n  erw [toOpen_comp_comap_assoc]\n  rfl\n\n"}
{"name":"AlgebraicGeometry.stalkMap_toStalk_apply","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëS\nx : CategoryTheory.ToType (CommRingCat.of ‚ÜëR)\n‚ä¢ Eq ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.sheafedSpaceMap f) p)) ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëR) ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p))) x)) ((CategoryTheory.CategoryStruct.comp f (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëS) p)) x)","decl":"@[elementwise]\ntheorem stalkMap_toStalk {R S : CommRingCat.{u}} (f : R ‚ü∂ S) (p : PrimeSpectrum S) :\n    toStalk R (PrimeSpectrum.comap f.hom p) ‚â´ (Spec.sheafedSpaceMap f).stalkMap p =\n      f ‚â´ toStalk S p := by\n  rw [‚Üê toOpen_germ S ‚ä§ p trivial, ‚Üê toOpen_germ R ‚ä§ (PrimeSpectrum.comap f.hom p) trivial,\n    Category.assoc]\n  erw [PresheafedSpace.stalkMap_germ (Spec.sheafedSpaceMap f) ‚ä§ p trivial]\n  rw [Spec.sheafedSpaceMap_c_app]\n  erw [toOpen_comp_comap_assoc]\n  rfl\n\n"}
{"name":"AlgebraicGeometry.localRingHom_comp_stalkIso","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëS\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.stalkIso (‚ÜëR) ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p)).hom (CategoryTheory.CategoryStruct.comp (CommRingCat.ofHom (Localization.localRingHom ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p).asIdeal p.asIdeal (CommRingCat.Hom.hom f) ‚ãØ)) (AlgebraicGeometry.StructureSheaf.stalkIso (‚ÜëS) p).inv)) (AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.sheafedSpaceMap f) p)","decl":"/-- Under the isomorphisms `stalkIso`, the map `stalkMap (Spec.sheafedSpaceMap f) p` corresponds\nto the induced local ring homomorphism `Localization.localRingHom`.\n-/\n@[elementwise]\ntheorem localRingHom_comp_stalkIso {R S : CommRingCat.{u}} (f : R ‚ü∂ S) (p : PrimeSpectrum S) :\n    (stalkIso R (PrimeSpectrum.comap f.hom p)).hom ‚â´\n      (CommRingCat.ofHom (Localization.localRingHom (PrimeSpectrum.comap f.hom p).asIdeal p.asIdeal\n          f.hom rfl)) ‚â´\n        (stalkIso S p).inv =\n      (Spec.sheafedSpaceMap f).stalkMap p :=\n  (stalkIso R (PrimeSpectrum.comap f.hom p)).eq_inv_comp.mp <|\n    (stalkIso S p).comp_inv_eq.mpr <| CommRingCat.hom_ext <|\n      Localization.localRingHom_unique _ _ _ (PrimeSpectrum.comap_asIdeal _ _) fun x => by\n        -- This used to be `rw`, but we need `erw` after https://github.com/leanprover/lean4/pull/2644 and https://github.com/leanprover-community/mathlib4/pull/8386\n        rw [stalkIso_hom, stalkIso_inv, CommRingCat.comp_apply, CommRingCat.comp_apply,\n            localizationToStalk_of]\n        erw [stalkMap_toStalk_apply f p x, stalkToFiberRingHom_toStalk]\n        rfl\n\n"}
{"name":"AlgebraicGeometry.localRingHom_comp_stalkIso_apply","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëS\nx : CategoryTheory.ToType ((AlgebraicGeometry.Spec.structureSheaf ‚ÜëR).presheaf.stalk ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p))\n‚ä¢ Eq ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.StructureSheaf.localizationToStalk (‚ÜëS) p)) ((Localization.localRingHom (Ideal.comap (CommRingCat.Hom.hom f) p.asIdeal) p.asIdeal (CommRingCat.Hom.hom f) ‚ãØ) ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.StructureSheaf.stalkToFiberRingHom (‚ÜëR) ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p))) x))) ((AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.sheafedSpaceMap f) p) x)","decl":"/-- Under the isomorphisms `stalkIso`, the map `stalkMap (Spec.sheafedSpaceMap f) p` corresponds\nto the induced local ring homomorphism `Localization.localRingHom`.\n-/\n@[elementwise]\ntheorem localRingHom_comp_stalkIso {R S : CommRingCat.{u}} (f : R ‚ü∂ S) (p : PrimeSpectrum S) :\n    (stalkIso R (PrimeSpectrum.comap f.hom p)).hom ‚â´\n      (CommRingCat.ofHom (Localization.localRingHom (PrimeSpectrum.comap f.hom p).asIdeal p.asIdeal\n          f.hom rfl)) ‚â´\n        (stalkIso S p).inv =\n      (Spec.sheafedSpaceMap f).stalkMap p :=\n  (stalkIso R (PrimeSpectrum.comap f.hom p)).eq_inv_comp.mp <|\n    (stalkIso S p).comp_inv_eq.mpr <| CommRingCat.hom_ext <|\n      Localization.localRingHom_unique _ _ _ (PrimeSpectrum.comap_asIdeal _ _) fun x => by\n        -- This used to be `rw`, but we need `erw` after https://github.com/leanprover/lean4/pull/2644 and https://github.com/leanprover-community/mathlib4/pull/8386\n        rw [stalkIso_hom, stalkIso_inv, CommRingCat.comp_apply, CommRingCat.comp_apply,\n            localizationToStalk_of]\n        erw [stalkMap_toStalk_apply f p x, stalkToFiberRingHom_toStalk]\n        rfl\n\n"}
{"name":"AlgebraicGeometry.localRingHom_comp_stalkIso_apply'","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëS\nx : ‚Üë((AlgebraicGeometry.Spec.structureSheaf ‚ÜëR).presheaf.stalk ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p))\n‚ä¢ Eq ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.StructureSheaf.stalkIso (‚ÜëS) p).inv) ((Localization.localRingHom ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p).asIdeal p.asIdeal (CommRingCat.Hom.hom f) ‚ãØ) ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.StructureSheaf.stalkIso (‚ÜëR) ((PrimeSpectrum.comap (CommRingCat.Hom.hom f)) p)).hom) x))) ((CategoryTheory.ConcreteCategory.hom (AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.sheafedSpaceMap f) p)) x)","decl":"/-- Version of `localRingHom_comp_stalkIso_apply` using `CommRingCat.Hom.hom` -/\ntheorem localRingHom_comp_stalkIso_apply' {R S : CommRingCat.{u}} (f : R ‚ü∂ S) (p : PrimeSpectrum S)\n    (x) :\n    (stalkIso S p).inv ((Localization.localRingHom (PrimeSpectrum.comap f.hom p).asIdeal p.asIdeal\n          f.hom rfl) ((stalkIso R (PrimeSpectrum.comap f.hom p)).hom x)) =\n      (Spec.sheafedSpaceMap f).stalkMap p x :=\n  localRingHom_comp_stalkIso_apply _ _ _\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceMap_toShHom","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\n‚ä¢ Eq (AlgebraicGeometry.LocallyRingedSpace.Hom.toShHom (AlgebraicGeometry.Spec.locallyRingedSpaceMap f)) (AlgebraicGeometry.Spec.sheafedSpaceMap f)","decl":"/--\nThe induced map of a ring homomorphism on the prime spectra, as a morphism of locally ringed spaces.\n-/\n@[simps toShHom]\ndef Spec.locallyRingedSpaceMap {R S : CommRingCat.{u}} (f : R ‚ü∂ S) :\n    Spec.locallyRingedSpaceObj S ‚ü∂ Spec.locallyRingedSpaceObj R :=\n  LocallyRingedSpace.Hom.mk (Spec.sheafedSpaceMap f) fun p =>\n    IsLocalHom.mk fun a ha => by\n      -- Here, we are showing that the map on prime spectra induced by `f` is really a morphism of\n      -- *locally* ringed spaces, i.e. that the induced map on the stalks is a local ring\n      -- homomorphism.\n\n      #adaptation_note /-- nightly-2024-04-01\n      It's this `erw` that is blowing up. The implicit arguments differ significantly. -/\n      erw [‚Üê localRingHom_comp_stalkIso_apply' f p a] at ha\n\n      have : IsLocalHom (stalkIso (‚ÜëS) p).inv.hom := isLocalHom_of_isIso _\n      replace ha := (isUnit_map_iff (stalkIso S p).inv.hom _).mp ha\n      replace ha := IsLocalHom.map_nonunit\n        ((stalkIso R ((PrimeSpectrum.comap f.hom) p)).hom a) ha\n      convert RingHom.isUnit_map (stalkIso R (PrimeSpectrum.comap f.hom p)).inv.hom ha\n      rw [‚Üê CommRingCat.comp_apply, Iso.hom_inv_id, CommRingCat.id_apply]\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceMap_id","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceMap (CategoryTheory.CategoryStruct.id R)) (CategoryTheory.CategoryStruct.id (AlgebraicGeometry.Spec.locallyRingedSpaceObj R))","decl":"@[simp]\ntheorem Spec.locallyRingedSpaceMap_id (R : CommRingCat.{u}) :\n    Spec.locallyRingedSpaceMap (ùüô R) = ùüô (Spec.locallyRingedSpaceObj R) :=\n  LocallyRingedSpace.Hom.ext' <| by\n    rw [Spec.locallyRingedSpaceMap_toShHom, Spec.sheafedSpaceMap_id]; rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.locallyRingedSpaceMap_comp","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S T : CommRingCat\nf : Quiver.Hom R S\ng : Quiver.Hom S T\n‚ä¢ Eq (AlgebraicGeometry.Spec.locallyRingedSpaceMap (CategoryTheory.CategoryStruct.comp f g)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.Spec.locallyRingedSpaceMap g) (AlgebraicGeometry.Spec.locallyRingedSpaceMap f))","decl":"theorem Spec.locallyRingedSpaceMap_comp {R S T : CommRingCat.{u}} (f : R ‚ü∂ S) (g : S ‚ü∂ T) :\n    Spec.locallyRingedSpaceMap (f ‚â´ g) =\n      Spec.locallyRingedSpaceMap g ‚â´ Spec.locallyRingedSpaceMap f :=\n  LocallyRingedSpace.Hom.ext' <| by\n    rw [Spec.locallyRingedSpaceMap_toShHom, Spec.sheafedSpaceMap_comp]; rfl\n\n"}
{"name":"AlgebraicGeometry.Spec.toLocallyRingedSpace_obj","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : Opposite CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.Spec.toLocallyRingedSpace.obj R) (AlgebraicGeometry.Spec.locallyRingedSpaceObj (Opposite.unop R))","decl":"/-- Spec, as a contravariant functor from commutative rings to locally ringed spaces.\n-/\n@[simps]\ndef Spec.toLocallyRingedSpace : CommRingCat.{u}·µí·µñ ‚•§ LocallyRingedSpace where\n  obj R := Spec.locallyRingedSpaceObj (unop R)\n  map f := Spec.locallyRingedSpaceMap f.unop\n  map_id R := by dsimp; rw [Spec.locallyRingedSpaceMap_id]\n  map_comp f g := by dsimp; rw [Spec.locallyRingedSpaceMap_comp]\n\n"}
{"name":"AlgebraicGeometry.Spec.toLocallyRingedSpace_map","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"X‚úù Y‚úù : Opposite CommRingCat\nf : Quiver.Hom X‚úù Y‚úù\n‚ä¢ Eq (AlgebraicGeometry.Spec.toLocallyRingedSpace.map f) (AlgebraicGeometry.Spec.locallyRingedSpaceMap f.unop)","decl":"/-- Spec, as a contravariant functor from commutative rings to locally ringed spaces.\n-/\n@[simps]\ndef Spec.toLocallyRingedSpace : CommRingCat.{u}·µí·µñ ‚•§ LocallyRingedSpace where\n  obj R := Spec.locallyRingedSpaceObj (unop R)\n  map f := Spec.locallyRingedSpaceMap f.unop\n  map_id R := by dsimp; rw [Spec.locallyRingedSpaceMap_id]\n  map_comp f g := by dsimp; rw [Spec.locallyRingedSpaceMap_comp]\n\n"}
{"name":"AlgebraicGeometry.isIso_toSpecŒì","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\n‚ä¢ CategoryTheory.IsIso (AlgebraicGeometry.toSpecŒì R)","decl":"instance isIso_toSpecŒì (R : CommRingCat.{u}) : IsIso (toSpecŒì R) := by\n  cases R; apply StructureSheaf.isIso_to_global\n\n"}
{"name":"AlgebraicGeometry.Spec_Œì_naturality_assoc","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\nZ : CommRingCat\nh : Quiver.Hom (AlgebraicGeometry.LocallyRingedSpace.Œì.obj { unop := AlgebraicGeometry.Spec.toLocallyRingedSpace.obj { unop := S } }) Z\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.toSpecŒì S) h)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.toSpecŒì R) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.LocallyRingedSpace.Œì.map (AlgebraicGeometry.Spec.toLocallyRingedSpace.map f.op).op) h))","decl":"@[reassoc]\ntheorem Spec_Œì_naturality {R S : CommRingCat.{u}} (f : R ‚ü∂ S) :\n    f ‚â´ toSpecŒì S = toSpecŒì R ‚â´ Œì.map (Spec.toLocallyRingedSpace.map f.op).op := by\n  -- Porting note (https://github.com/leanprover-community/mathlib4/issues/11041): `ext` failed to pick up one of the three lemmas\n  ext : 2\n  refine Subtype.ext <| funext fun x' => ?_; symm\n  apply Localization.localRingHom_to_map\n\n"}
{"name":"AlgebraicGeometry.Spec_Œì_naturality","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f (AlgebraicGeometry.toSpecŒì S)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.toSpecŒì R) (AlgebraicGeometry.LocallyRingedSpace.Œì.map (AlgebraicGeometry.Spec.toLocallyRingedSpace.map f.op).op))","decl":"@[reassoc]\ntheorem Spec_Œì_naturality {R S : CommRingCat.{u}} (f : R ‚ü∂ S) :\n    f ‚â´ toSpecŒì S = toSpecŒì R ‚â´ Œì.map (Spec.toLocallyRingedSpace.map f.op).op := by\n  -- Porting note (https://github.com/leanprover-community/mathlib4/issues/11041): `ext` failed to pick up one of the three lemmas\n  ext : 2\n  refine Subtype.ext <| funext fun x' => ?_; symm\n  apply Localization.localRingHom_to_map\n\n"}
{"name":"AlgebraicGeometry.LocallyRingedSpace.SpecŒìIdentity_inv_app","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"X : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.LocallyRingedSpace.SpecŒìIdentity.inv.app X) (AlgebraicGeometry.toSpecŒì X)","decl":"/-- The counit (`SpecŒìIdentity.inv.op`) of the adjunction `Œì ‚ä£ Spec` is an isomorphism. -/\n@[simps! hom_app inv_app]\ndef LocallyRingedSpace.SpecŒìIdentity : Spec.toLocallyRingedSpace.rightOp ‚ãô Œì ‚âÖ ùü≠ _ :=\n  Iso.symm <| NatIso.ofComponents.{u,u,u+1,u+1} (fun R =>\n    -- Porting note: In Lean3, this `IsIso` is synthesized automatically\n    letI : IsIso (toSpecŒì R) := StructureSheaf.isIso_to_global _\n    asIso (toSpecŒì R)) fun {X Y} f => by convert Spec_Œì_naturality (R := X) (S := Y) f\n\n"}
{"name":"AlgebraicGeometry.LocallyRingedSpace.SpecŒìIdentity_hom_app","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"X : CommRingCat\n‚ä¢ Eq (AlgebraicGeometry.LocallyRingedSpace.SpecŒìIdentity.hom.app X) (CategoryTheory.inv (AlgebraicGeometry.toSpecŒì X))","decl":"/-- The counit (`SpecŒìIdentity.inv.op`) of the adjunction `Œì ‚ä£ Spec` is an isomorphism. -/\n@[simps! hom_app inv_app]\ndef LocallyRingedSpace.SpecŒìIdentity : Spec.toLocallyRingedSpace.rightOp ‚ãô Œì ‚âÖ ùü≠ _ :=\n  Iso.symm <| NatIso.ofComponents.{u,u,u+1,u+1} (fun R =>\n    -- Porting note: In Lean3, this `IsIso` is synthesized automatically\n    letI : IsIso (toSpecŒì R) := StructureSheaf.isIso_to_global _\n    asIso (toSpecŒì R)) fun {X Y} f => by convert Spec_Œì_naturality (R := X) (S := Y) f\n\n"}
{"name":"AlgebraicGeometry.Spec_map_localization_isIso","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R : CommRingCat\nM : Submonoid ‚ÜëR\nx : PrimeSpectrum (Localization M)\n‚ä¢ CategoryTheory.IsIso (AlgebraicGeometry.PresheafedSpace.Hom.stalkMap (AlgebraicGeometry.Spec.toPresheafedSpace.map (CommRingCat.ofHom (algebraMap (‚ÜëR) (Localization M))).op) x)","decl":"/-- The stalk map of `Spec M‚Åª¬πR ‚ü∂ Spec R` is an iso for each `p : Spec M‚Åª¬πR`. -/\ntheorem Spec_map_localization_isIso (R : CommRingCat.{u}) (M : Submonoid R)\n    (x : PrimeSpectrum (Localization M)) :\n    IsIso\n      ((Spec.toPresheafedSpace.map\n        (CommRingCat.ofHom (algebraMap R (Localization M))).op).stalkMap x) := by\n  erw [‚Üê localRingHom_comp_stalkIso]\n  -- Porting note: replaced `apply (config := { instances := false })`.\n  -- See https://github.com/leanprover/lean4/issues/2273\n  refine IsIso.comp_isIso' inferInstance (IsIso.comp_isIso' ?_ inferInstance)\n  /- I do not know why this is defeq to the goal, but I'm happy to accept that it is. -/\n  show\n    IsIso (IsLocalization.localizationLocalizationAtPrimeIsoLocalization M\n      x.asIdeal).toRingEquiv.toCommRingCatIso.hom\n  infer_instance\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.toPushforwardStalk_comp_assoc","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëR\nZ : CommRingCat\nh : Quiver.Hom (((TopCat.Presheaf.pushforward CommRingCat (AlgebraicGeometry.Spec.topMap f)).obj (AlgebraicGeometry.Spec.structureSheaf ‚ÜëS).val).stalk p) Z\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toPushforwardStalk f p) h)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëR) p) (CategoryTheory.CategoryStruct.comp ((TopCat.Presheaf.stalkFunctor CommRingCat p).map (AlgebraicGeometry.Spec.sheafedSpaceMap f).c) h))","decl":"@[reassoc]\ntheorem toPushforwardStalk_comp :\n    f ‚â´ StructureSheaf.toPushforwardStalk f p =\n      StructureSheaf.toStalk R p ‚â´\n        (TopCat.Presheaf.stalkFunctor _ _).map (Spec.sheafedSpaceMap f).c := by\n  rw [StructureSheaf.toStalk, Category.assoc, TopCat.Presheaf.stalkFunctor_map_germ]\n  exact Spec_Œì_naturality_assoc f _\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.toPushforwardStalk_comp","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëR\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f (AlgebraicGeometry.StructureSheaf.toPushforwardStalk f p)) (CategoryTheory.CategoryStruct.comp (AlgebraicGeometry.StructureSheaf.toStalk (‚ÜëR) p) ((TopCat.Presheaf.stalkFunctor CommRingCat p).map (AlgebraicGeometry.Spec.sheafedSpaceMap f).c))","decl":"@[reassoc]\ntheorem toPushforwardStalk_comp :\n    f ‚â´ StructureSheaf.toPushforwardStalk f p =\n      StructureSheaf.toStalk R p ‚â´\n        (TopCat.Presheaf.stalkFunctor _ _).map (Spec.sheafedSpaceMap f).c := by\n  rw [StructureSheaf.toStalk, Category.assoc, TopCat.Presheaf.stalkFunctor_map_germ]\n  exact Spec_Œì_naturality_assoc f _\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.algebraMap_pushforward_stalk","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\nf : Quiver.Hom R S\np : PrimeSpectrum ‚ÜëR\n‚ä¢ Eq (algebraMap ‚ÜëR ‚Üë(((TopCat.Presheaf.pushforward CommRingCat (AlgebraicGeometry.Spec.topMap f)).obj (AlgebraicGeometry.Spec.structureSheaf ‚ÜëS).val).stalk p)) (CommRingCat.Hom.hom (CategoryTheory.CategoryStruct.comp f (AlgebraicGeometry.StructureSheaf.toPushforwardStalk f p)))","decl":"theorem algebraMap_pushforward_stalk :\n    algebraMap R ((Spec.topMap f _* (structureSheaf S).1).stalk p) =\n      (f ‚â´ StructureSheaf.toPushforwardStalk f p).hom :=\n  rfl\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.toPushforwardStalkAlgHom_apply","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\np : PrimeSpectrum ‚ÜëR\ninst‚úù : Algebra ‚ÜëR ‚ÜëS\na‚úù : ‚Üë(CommRingCat.of ‚ÜëS)\n‚ä¢ Eq ((AlgebraicGeometry.StructureSheaf.toPushforwardStalkAlgHom R S p) a‚úù) ((((TopCat.Presheaf.pushforward CommRingCat (AlgebraicGeometry.Spec.topMap (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS)))).obj (AlgebraicGeometry.Spec.structureSheaf ‚ÜëS).val).germ Top.top p trivial).hom' ((AlgebraicGeometry.StructureSheaf.toOpen (‚ÜëS) Top.top).hom' a‚úù))","decl":"/--\nThis is the `AlgHom` version of `toPushforwardStalk`, which is the map `S ‚ü∂ (f‚àó ùí™‚Çõ)‚Çö` for some\nalgebra `R ‚ü∂ S` and some `p : Spec R`.\n-/\n@[simps!]\ndef toPushforwardStalkAlgHom :\n    S ‚Üí‚Çê[R] (Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).1).stalk p :=\n  { (StructureSheaf.toPushforwardStalk (CommRingCat.ofHom (algebraMap R S)) p).hom with\n    commutes' := fun _ => rfl }\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.isLocalizedModule_toPushforwardStalkAlgHom_aux","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\np : PrimeSpectrum ‚ÜëR\ninst‚úù : Algebra ‚ÜëR ‚ÜëS\ny : ‚Üë(((TopCat.Presheaf.pushforward CommRingCat (AlgebraicGeometry.Spec.topMap (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS)))).obj (AlgebraicGeometry.Spec.structureSheaf ‚ÜëS).val).stalk p)\n‚ä¢ Exists fun x => Eq (HSMul.hSMul x.2 y) ((AlgebraicGeometry.StructureSheaf.toPushforwardStalkAlgHom R S p) x.1)","decl":"theorem isLocalizedModule_toPushforwardStalkAlgHom_aux (y) :\n    ‚àÉ x : S √ó p.asIdeal.primeCompl, x.2 ‚Ä¢ y = toPushforwardStalkAlgHom R S p x.1 := by\n  obtain ‚ü®U, hp, s, e‚ü© := TopCat.Presheaf.germ_exist\n    -- Porting note: originally the first variable does not need to be explicit\n    (Spec.topMap (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS)) _* (structureSheaf S).val) _ y\n  obtain ‚ü®_, ‚ü®r, rfl‚ü©, hpr : p ‚àà PrimeSpectrum.basicOpen r, hrU : PrimeSpectrum.basicOpen r ‚â§ U‚ü© :=\n    PrimeSpectrum.isTopologicalBasis_basic_opens.exists_subset_of_mem_open (show p ‚àà U from hp) U.2\n  change PrimeSpectrum.basicOpen r ‚â§ U at hrU\n  replace e :=\n    ((Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).1).germ_res_apply\n      (homOfLE hrU) p hpr _).trans e\n  set s' := (Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).1).map\n      (homOfLE hrU).op s with h\n  replace e : ((Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).val).germ _\n      p hpr) s' = y := by\n    rw [h]; exact e\n  clear_value s'; clear! U\n  obtain ‚ü®‚ü®s, ‚ü®_, n, rfl‚ü©‚ü©, hsn‚ü© :=\n    @IsLocalization.surj _ _ _ _ _ _\n      (StructureSheaf.IsLocalization.to_basicOpen S <| algebraMap R S r) s'\n  refine ‚ü®‚ü®s, ‚ü®r, hpr‚ü© ^ n‚ü©, ?_‚ü©\n  rw [Submonoid.smul_def, Algebra.smul_def, algebraMap_pushforward_stalk, toPushforwardStalk,\n    CommRingCat.comp_apply, CommRingCat.comp_apply]\n  iterate 2\n    erw [‚Üê (Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).1).germ_res_apply\n      (homOfLE le_top) p hpr]\n  rw [‚Üê e]\n  -- Porting note: without this `change`, Lean doesn't know how to rewrite `map_mul`\n  let f := TopCat.Presheaf.germ (Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _*\n      (structureSheaf S).val) _ p hpr\n  change f _ * f _ = f _\n  rw [‚Üê map_mul, mul_comm]\n  dsimp only [Subtype.coe_mk] at hsn\n  rw [‚Üê map_pow (algebraMap R S)] at hsn\n  congr 1\n\n"}
{"name":"AlgebraicGeometry.StructureSheaf.isLocalizedModule_toPushforwardStalkAlgHom","module":"Mathlib.AlgebraicGeometry.Spec","initialProofState":"R S : CommRingCat\np : PrimeSpectrum ‚ÜëR\ninst‚úù : Algebra ‚ÜëR ‚ÜëS\n‚ä¢ IsLocalizedModule p.asIdeal.primeCompl (AlgebraicGeometry.StructureSheaf.toPushforwardStalkAlgHom R S p).toLinearMap","decl":"instance isLocalizedModule_toPushforwardStalkAlgHom :\n    IsLocalizedModule p.asIdeal.primeCompl (toPushforwardStalkAlgHom R S p).toLinearMap := by\n  apply IsLocalizedModule.mkOfAlgebra\n  ¬∑ intro x hx; rw [algebraMap_pushforward_stalk, toPushforwardStalk_comp]\n    change IsUnit ((TopCat.Presheaf.stalkFunctor CommRingCat p).map\n      (Spec.sheafedSpaceMap (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS))).c _)\n    exact (IsLocalization.map_units ((structureSheaf R).presheaf.stalk p) ‚ü®x, hx‚ü©).map _\n  ¬∑ apply isLocalizedModule_toPushforwardStalkAlgHom_aux\n  ¬∑ intro x hx\n    rw [toPushforwardStalkAlgHom_apply,\n      ‚Üê (toPushforwardStalk (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS)) p).hom.map_zero,\n      toPushforwardStalk] at hx\n    -- Porting note: this `change` is manually rewriting `comp_apply`\n    change _ = (TopCat.Presheaf.germ (Spec.topMap (CommRingCat.ofHom (algebraMap ‚ÜëR ‚ÜëS)) _*\n      (structureSheaf ‚ÜëS).val) ‚ä§ p trivial (toOpen S ‚ä§ 0)) at hx\n    rw [map_zero] at hx\n    change (forget CommRingCat).map _ _ = (forget _).map _ _ at hx\n    obtain ‚ü®U, hpU, i‚ÇÅ, i‚ÇÇ, e‚ü© := TopCat.Presheaf.germ_eq _ _ _ _ _ _ hx\n    obtain ‚ü®_, ‚ü®r, rfl‚ü©, hpr, hrU‚ü© :=\n      PrimeSpectrum.isTopologicalBasis_basic_opens.exists_subset_of_mem_open (show p ‚àà U.1 from hpU)\n        U.2\n    change PrimeSpectrum.basicOpen r ‚â§ U at hrU\n    apply_fun (Spec.topMap (CommRingCat.ofHom (algebraMap R S)) _* (structureSheaf S).1).map\n        (homOfLE hrU).op at e\n    simp only [Functor.op_map, map_zero, ‚Üê CategoryTheory.comp_apply, toOpen_res] at e\n    have : toOpen S (PrimeSpectrum.basicOpen <| algebraMap R S r) x = 0 := by\n      refine Eq.trans ?_ e; rfl\n    have :=\n      (@IsLocalization.mk'_one _ _ _ _ _ _\n            (StructureSheaf.IsLocalization.to_basicOpen S <| algebraMap R S r) x).trans\n        this\n    obtain ‚ü®‚ü®_, n, rfl‚ü©, e‚ü© := (IsLocalization.mk'_eq_zero_iff _ _).mp this\n    refine ‚ü®‚ü®r, hpr‚ü© ^ n, ?_‚ü©\n    rw [Submonoid.smul_def, Algebra.smul_def]\n    -- Porting note: manually rewrite `Submonoid.coe_pow`\n    change (algebraMap R S) (r ^ n) * x = 0\n    rw [map_pow]\n    exact e\n\n"}
