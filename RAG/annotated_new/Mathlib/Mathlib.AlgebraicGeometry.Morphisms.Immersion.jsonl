{"name":"AlgebraicGeometry.isImmersion_iff","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\n‚ä¢ Iff (AlgebraicGeometry.IsImmersion f) (And (AlgebraicGeometry.IsPreimmersion f) (IsLocallyClosed (Set.range ‚áëf.base)))","decl":"/-- A morphism of schemes `f : X ‚ü∂ Y` is an immersion if\n1. the underlying map of topological spaces is an embedding\n2. the range of the map is locally closed\n3. the induced morphisms of stalks are all surjective. -/\n@[mk_iff]\nclass IsImmersion (f : X ‚ü∂ Y) extends IsPreimmersion f : Prop where\n  isLocallyClosed_range : IsLocallyClosed (Set.range f.base)\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.isLocallyClosed_range","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\nself : AlgebraicGeometry.IsImmersion f\n‚ä¢ IsLocallyClosed (Set.range ‚áëf.base)","decl":"/-- A morphism of schemes `f : X ‚ü∂ Y` is an immersion if\n1. the underlying map of topological spaces is an embedding\n2. the range of the map is locally closed\n3. the induced morphisms of stalks are all surjective. -/\n@[mk_iff]\nclass IsImmersion (f : X ‚ü∂ Y) extends IsPreimmersion f : Prop where\n  isLocallyClosed_range : IsLocallyClosed (Set.range f.base)\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.toIsPreimmersion","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\nself : AlgebraicGeometry.IsImmersion f\n‚ä¢ AlgebraicGeometry.IsPreimmersion f","decl":"/-- A morphism of schemes `f : X ‚ü∂ Y` is an immersion if\n1. the underlying map of topological spaces is an embedding\n2. the range of the map is locally closed\n3. the induced morphisms of stalks are all surjective. -/\n@[mk_iff]\nclass IsImmersion (f : X ‚ü∂ Y) extends IsPreimmersion f : Prop where\n  isLocallyClosed_range : IsLocallyClosed (Set.range f.base)\n\n"}
{"name":"AlgebraicGeometry.Scheme.Hom.isLocallyClosed_range","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : X.Hom Y\ninst‚úù : AlgebraicGeometry.IsImmersion f\n‚ä¢ IsLocallyClosed (Set.range ‚áëf.base)","decl":"lemma Scheme.Hom.isLocallyClosed_range (f : X.Hom Y) [IsImmersion f] :\n    IsLocallyClosed (Set.range f.base) :=\n  IsImmersion.isLocallyClosed_range\n\n"}
{"name":"AlgebraicGeometry.Scheme.Hom.liftCoborder_Œπ","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : X.Hom Y\ninst‚úù : AlgebraicGeometry.IsImmersion f\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f.liftCoborder f.coborderRange.Œπ) f","decl":"/--\nAny (locally-closed) immersion can be factored into\na closed immersion followed by a (dominant) open immersion.\n-/\n@[reassoc (attr := simp)]\nlemma Scheme.Hom.liftCoborder_Œπ (f : X.Hom Y) [IsImmersion f] :\n    f.liftCoborder ‚â´ f.coborderRange.Œπ = f :=\n  IsOpenImmersion.lift_fac _ _ _\n\n"}
{"name":"AlgebraicGeometry.Scheme.Hom.liftCoborder_Œπ_assoc","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : X.Hom Y\ninst‚úù : AlgebraicGeometry.IsImmersion f\nZ : AlgebraicGeometry.Scheme\nh : Quiver.Hom Y Z\n‚ä¢ Eq (CategoryTheory.CategoryStruct.comp f.liftCoborder (CategoryTheory.CategoryStruct.comp f.coborderRange.Œπ h)) (CategoryTheory.CategoryStruct.comp f h)","decl":"/--\nAny (locally-closed) immersion can be factored into\na closed immersion followed by a (dominant) open immersion.\n-/\n@[reassoc (attr := simp)]\nlemma Scheme.Hom.liftCoborder_Œπ (f : X.Hom Y) [IsImmersion f] :\n    f.liftCoborder ‚â´ f.coborderRange.Œπ = f :=\n  IsOpenImmersion.lift_fac _ _ _\n\n"}
{"name":"AlgebraicGeometry.instIsClosedImmersionLiftCoborder","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ninst‚úù : AlgebraicGeometry.IsImmersion f\n‚ä¢ AlgebraicGeometry.IsClosedImmersion (AlgebraicGeometry.Scheme.Hom.liftCoborder f)","decl":"instance [IsImmersion f] : IsClosedImmersion f.liftCoborder := by\n  have : IsPreimmersion (f.liftCoborder ‚â´ f.coborderRange.Œπ) := by\n    simp only [Scheme.Hom.liftCoborder_Œπ]; infer_instance\n  have : IsPreimmersion f.liftCoborder := .of_comp f.liftCoborder f.coborderRange.Œπ\n  refine .of_isPreimmersion _ ?_\n  convert isClosed_preimage_val_coborder\n  apply Set.image_injective.mpr f.coborderRange.Œπ.isEmbedding.injective\n  rw [‚Üê Set.range_comp, ‚Üê TopCat.coe_comp, ‚Üê Scheme.comp_base, f.liftCoborder_Œπ]\n  exact (Set.image_preimage_eq_of_subset (by simpa using subset_coborder)).symm\n\n"}
{"name":"AlgebraicGeometry.instIsDominantŒπCoborderRange","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ninst‚úù : AlgebraicGeometry.IsImmersion f\n‚ä¢ AlgebraicGeometry.IsDominant (AlgebraicGeometry.Scheme.Hom.coborderRange f).Œπ","decl":"instance [IsImmersion f] : IsDominant f.coborderRange.Œπ := by\n  rw [isDominant_iff, DenseRange, Scheme.Opens.range_Œπ]\n  exact dense_coborder\n\n"}
{"name":"AlgebraicGeometry.isImmersion_eq_inf","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"‚ä¢ Eq (@AlgebraicGeometry.IsImmersion) (Min.min (@AlgebraicGeometry.IsPreimmersion) (AlgebraicGeometry.topologically fun {x x_1} x_2 x_3 f => IsLocallyClosed (Set.range f)))","decl":"lemma isImmersion_eq_inf : @IsImmersion = (@IsPreimmersion ‚äì\n    topologically fun {_ _} _ _ f ‚Ü¶ IsLocallyClosed (Set.range f) : MorphismProperty Scheme) := by\n  ext; exact isImmersion_iff _\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instIsLocalAtTarget","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"‚ä¢ AlgebraicGeometry.IsLocalAtTarget @AlgebraicGeometry.IsImmersion","decl":"instance : IsLocalAtTarget @IsImmersion := by\n  suffices IsLocalAtTarget (topologically fun {X Y} _ _ f ‚Ü¶ IsLocallyClosed (Set.range f)) from\n    isImmersion_eq_inf ‚ñ∏ inferInstance\n  apply (config := { allowSynthFailures := true }) topologically_isLocalAtTarget'\n  ¬∑ refine { precomp := ?_, postcomp := ?_ }\n    ¬∑ intro X Y Z i hi f hf\n      replace hi : IsIso i := hi\n      show IsLocallyClosed _\n      simpa only [Scheme.comp_coeBase, TopCat.coe_comp, Set.range_comp,\n        Set.range_eq_univ.mpr i.surjective, Set.image_univ]\n    ¬∑ intro X Y Z i hi f hf\n      replace hi : IsIso i := hi\n      show IsLocallyClosed _\n      simp only [Scheme.comp_coeBase, TopCat.coe_comp, Set.range_comp]\n      refine hf.image i.homeomorph.isInducing ?_\n      rw [Set.range_eq_univ.mpr i.surjective]\n      exact isOpen_univ.isLocallyClosed\n  ¬∑ simp_rw [Set.range_restrictPreimage]\n    exact fun _ _ _ e _ ‚Ü¶ isLocallyClosed_iff_coe_preimage_of_iSup_eq_top e _\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instOfIsOpenImmersion","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ninst‚úù : AlgebraicGeometry.IsOpenImmersion f\n‚ä¢ AlgebraicGeometry.IsImmersion f","decl":"instance (priority := 900) {X Y : Scheme} (f : X ‚ü∂ Y) [IsOpenImmersion f] : IsImmersion f where\n  isLocallyClosed_range := f.isOpenEmbedding.2.isLocallyClosed\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instOfIsClosedImmersion","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ninst‚úù : AlgebraicGeometry.IsClosedImmersion f\n‚ä¢ AlgebraicGeometry.IsImmersion f","decl":"instance (priority := 900) {X Y : Scheme} (f : X ‚ü∂ Y) [IsClosedImmersion f] : IsImmersion f where\n  isLocallyClosed_range := f.isClosedEmbedding.2.isLocallyClosed\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instIsMultiplicativeScheme","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"‚ä¢ CategoryTheory.MorphismProperty.IsMultiplicative @AlgebraicGeometry.IsImmersion","decl":"instance : MorphismProperty.IsMultiplicative @IsImmersion where\n  id_mem _ := inferInstance\n  comp_mem {X Y Z} f g hf hg := by\n    refine { __ := inferInstanceAs (IsPreimmersion (f ‚â´ g)), isLocallyClosed_range := ?_ }\n    simp only [Scheme.comp_coeBase, TopCat.coe_comp, Set.range_comp]\n    exact f.isLocallyClosed_range.image g.isEmbedding.isInducing g.isLocallyClosed_range\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.comp","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y Z : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ng : Quiver.Hom Y Z\ninst‚úù¬π : AlgebraicGeometry.IsImmersion f\ninst‚úù : AlgebraicGeometry.IsImmersion g\n‚ä¢ AlgebraicGeometry.IsImmersion (CategoryTheory.CategoryStruct.comp f g)","decl":"instance comp {X Y Z : Scheme} (f : X ‚ü∂ Y) (g : Y ‚ü∂ Z) [IsImmersion f]\n    [IsImmersion g] : IsImmersion (f ‚â´ g) :=\n  MorphismProperty.IsStableUnderComposition.comp_mem f g inferInstance inferInstance\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.isImmersion_iff_exists","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\n‚ä¢ Iff (AlgebraicGeometry.IsImmersion f) (Exists fun Z => Exists fun g‚ÇÅ => Exists fun g‚ÇÇ => And (AlgebraicGeometry.IsClosedImmersion g‚ÇÅ) (And (AlgebraicGeometry.IsOpenImmersion g‚ÇÇ) (Eq (CategoryTheory.CategoryStruct.comp g‚ÇÅ g‚ÇÇ) f)))","decl":"variable {f} in\n/--\nA morphism is a (locally-closed) immersion if and only if it can be factored into\na closed immersion followed by an open immersion.\n-/\nlemma isImmersion_iff_exists : IsImmersion f ‚Üî ‚àÉ (Z : Scheme) (g‚ÇÅ : X ‚ü∂ Z) (g‚ÇÇ : Z ‚ü∂ Y),\n    IsClosedImmersion g‚ÇÅ ‚àß IsOpenImmersion g‚ÇÇ ‚àß g‚ÇÅ ‚â´ g‚ÇÇ = f :=\n  ‚ü®fun _ ‚Ü¶ ‚ü®_, f.liftCoborder, f.coborderRange.Œπ, inferInstance, inferInstance, f.liftCoborder_Œπ‚ü©,\n    fun ‚ü®_, _, _, _, _, e‚ü© ‚Ü¶ e ‚ñ∏ inferInstance‚ü©\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.of_comp","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y Z : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ng : Quiver.Hom Y Z\ninst‚úù¬π : AlgebraicGeometry.IsImmersion g\ninst‚úù : AlgebraicGeometry.IsImmersion (CategoryTheory.CategoryStruct.comp f g)\n‚ä¢ AlgebraicGeometry.IsImmersion f","decl":"theorem of_comp {X Y Z : Scheme} (f : X ‚ü∂ Y) (g : Y ‚ü∂ Z) [IsImmersion g]\n    [IsImmersion (f ‚â´ g)] : IsImmersion f where\n  __ := IsPreimmersion.of_comp f g\n  isLocallyClosed_range := by\n    rw [‚Üê Set.preimage_image_eq (Set.range _) g.isEmbedding.injective]\n    have := (f ‚â´ g).isLocallyClosed_range.preimage g.base.2\n    simpa only [Scheme.comp_coeBase, TopCat.coe_comp, Set.range_comp] using this\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.comp_iff","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y Z : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\ng : Quiver.Hom Y Z\ninst‚úù : AlgebraicGeometry.IsImmersion g\n‚ä¢ Iff (AlgebraicGeometry.IsImmersion (CategoryTheory.CategoryStruct.comp f g)) (AlgebraicGeometry.IsImmersion f)","decl":"theorem comp_iff {X Y Z : Scheme} (f : X ‚ü∂ Y) (g : Y ‚ü∂ Z) [IsImmersion g] :\n    IsImmersion (f ‚â´ g) ‚Üî IsImmersion f :=\n  ‚ü®fun _ ‚Ü¶ of_comp f g, fun _ ‚Ü¶ inferInstance‚ü©\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.isStableUnderBaseChange","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"‚ä¢ CategoryTheory.MorphismProperty.IsStableUnderBaseChange @AlgebraicGeometry.IsImmersion","decl":"instance isStableUnderBaseChange : MorphismProperty.IsStableUnderBaseChange @IsImmersion where\n  of_isPullback := by\n    intros X Y Y' S f g f' g' H hg\n    let Z := Limits.pullback f g.coborderRange.Œπ\n    let e : Y' ‚ü∂ Z := Limits.pullback.lift g' (f' ‚â´ g.liftCoborder) (by simpa using H.w.symm)\n    have : IsClosedImmersion e := by\n      have := (IsPullback.paste_horiz_iff (.of_hasPullback f g.coborderRange.Œπ)\n        (show e ‚â´ Limits.pullback.snd _ _ = _ from Limits.pullback.lift_snd _ _ _)).mp ?_\n      ¬∑ exact MorphismProperty.of_isPullback this.flip inferInstance\n      ¬∑ simpa [e] using H.flip\n    rw [‚Üê Limits.pullback.lift_fst (f := f) (g := g.coborderRange.Œπ) g' (f' ‚â´ g.liftCoborder)\n      (by simpa using H.w.symm)]\n    infer_instance\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instDiagonalScheme","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf : Quiver.Hom X Y\n‚ä¢ AlgebraicGeometry.IsImmersion (CategoryTheory.Limits.pullback.diagonal f)","decl":"open Limits Scheme.Pullback in\n/-- The diagonal morphism is always an immersion. -/\n@[stacks 01KJ]\ninstance : IsImmersion (pullback.diagonal f) := by\n  let ùí∞ := Y.affineCover\n  let ùí± (i) := (pullback f (ùí∞.map i)).affineCover\n  have H : pullback.diagonal f ‚Åª¬π·µÅ diagonalCoverDiagonalRange f ùí∞ ùí± = ‚ä§ :=\n    top_le_iff.mp fun _ _ ‚Ü¶ range_diagonal_subset_diagonalCoverDiagonalRange _ _ _ ‚ü®_, rfl‚ü©\n  have := isClosedImmersion_diagonal_restrict_diagonalCoverDiagonalRange f ùí∞ ùí±\n  have : IsImmersion ((pullback.diagonal f ‚à£_\n    diagonalCoverDiagonalRange f ùí∞ ùí±) ‚â´ Scheme.Opens.Œπ _) := inferInstance\n  rwa [morphismRestrict_Œπ, H, ‚Üê Scheme.topIso_hom,\n    MorphismProperty.cancel_left_of_respectsIso (P := @IsImmersion)] at this\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instLiftSchemeId","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X : AlgebraicGeometry.Scheme\n‚ä¢ AlgebraicGeometry.IsImmersion (CategoryTheory.Limits.prod.lift (CategoryTheory.CategoryStruct.id X) (CategoryTheory.CategoryStruct.id X))","decl":"instance : IsImmersion (prod.lift (ùüô X) (ùüô X)) := by\n  rw [‚Üê MorphismProperty.cancel_right_of_respectsIso @IsImmersion _ (prodIsoPullback X X).hom]\n  convert inferInstanceAs (IsImmersion (pullback.diagonal (terminal.from X)))\n  ext : 1 <;> simp\n\n"}
{"name":"AlgebraicGeometry.IsImmersion.instŒπScheme","module":"Mathlib.AlgebraicGeometry.Morphisms.Immersion","initialProofState":"X Y : AlgebraicGeometry.Scheme\nf g : Quiver.Hom X Y\n‚ä¢ AlgebraicGeometry.IsImmersion (CategoryTheory.Limits.equalizer.Œπ f g)","decl":"instance (f g : X ‚ü∂ Y) : IsImmersion (equalizer.Œπ f g) :=\n  MorphismProperty.of_isPullback (P := @IsImmersion)\n    (isPullback_equalizer_prod f g).flip inferInstance\n\n"}
