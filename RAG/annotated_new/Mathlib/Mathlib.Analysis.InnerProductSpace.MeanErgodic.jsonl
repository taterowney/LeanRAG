{"name":"LinearMap.tendsto_birkhoffAverage_of_ker_subset_closure","module":"Mathlib.Analysis.InnerProductSpace.MeanErgodic","initialProofState":"ğ•œ : Type u_1\nE : Type u_2\ninstâœÂ² : RCLike ğ•œ\ninstâœÂ¹ : NormedAddCommGroup E\ninstâœ : NormedSpace ğ•œ E\nf : LinearMap (RingHom.id ğ•œ) E E\nhf : LipschitzWith 1 â‡‘f\ng : ContinuousLinearMap (RingHom.id ğ•œ) E (Subtype fun x => Membership.mem (LinearMap.eqLocus f 1) x)\nhg_proj : âˆ€ (x : Subtype fun x => Membership.mem (LinearMap.eqLocus f 1) x), Eq (g â†‘x) x\nhg_ker : HasSubset.Subset (â†‘(LinearMap.ker g)) (closure â†‘(LinearMap.range (HSub.hSub f 1)))\nx : E\nâŠ¢ Filter.Tendsto (fun x_1 => birkhoffAverage ğ•œ (â‡‘f) id x_1 x) Filter.atTop (nhds â†‘(g x))","decl":"/-- **Von Neumann Mean Ergodic Theorem**, a version for a normed space.\n\nLet `f : E â†’ E` be a contracting linear self-map of a normed space.\nLet `S` be the subspace of fixed points of `f`.\nLet `g : E â†’ S` be a continuous linear projection, `g|_S=id`.\nIf the range of `f - id` is dense in the kernel of `g`,\nthen for each `x`, the Birkhoff averages\n```\nbirkhoffAverage ğ•œ f id N x = (N : ğ•œ)â»Â¹ â€¢ âˆ‘ n âˆˆ Finset.range N, f^[n] x\n```\nconverge to `g x` as `N â†’ âˆ`.\n\nUsually, this fact is not formulated as a separate lemma.\nI chose to do it in order to isolate parts of the proof that do not rely\non the inner product space structure.\n-/\ntheorem LinearMap.tendsto_birkhoffAverage_of_ker_subset_closure [NormedSpace ğ•œ E]\n    (f : E â†’â‚—[ğ•œ] E) (hf : LipschitzWith 1 f) (g : E â†’L[ğ•œ] LinearMap.eqLocus f 1)\n    (hg_proj : âˆ€ x : LinearMap.eqLocus f 1, g x = x)\n    (hg_ker : (LinearMap.ker g : Set E) âŠ† closure (LinearMap.range (f - 1))) (x : E) :\n    Tendsto (birkhoffAverage ğ•œ f _root_.id Â· x) atTop (ğ“ (g x)) := by\n  /- Any point can be represented as a sum of `y âˆˆ LinearMap.ker g` and a fixed point `z`. -/\n  obtain âŸ¨y, hy, z, hz, rflâŸ© : âˆƒ y, g y = 0 âˆ§ âˆƒ z, IsFixedPt f z âˆ§ x = y + z :=\n    âŸ¨x - g x, by simp [hg_proj], g x, (g x).2, by simpâŸ©\n  /- For a fixed point, the theorem is trivial,\n  so it suffices to prove it for `y âˆˆ LinearMap.ker g`. -/\n  suffices Tendsto (birkhoffAverage ğ•œ f _root_.id Â· y) atTop (ğ“ 0) by\n    have hgz : g z = z := congr_arg Subtype.val (hg_proj âŸ¨z, hzâŸ©)\n    simpa [hy, hgz, birkhoffAverage, birkhoffSum, Finset.sum_add_distrib, smul_add]\n      using this.add (hz.tendsto_birkhoffAverage ğ•œ _root_.id)\n  /- By continuity, it suffices to prove the theorem on a dense subset of `LinearMap.ker g`.\n  By assumption, `LinearMap.range (f - 1)` is dense in the kernel of `g`,\n  so it suffices to prove the theorem for `y = f x - x`. -/\n  have : IsClosed {x | Tendsto (birkhoffAverage ğ•œ f _root_.id Â· x) atTop (ğ“ 0)} :=\n    isClosed_setOf_tendsto_birkhoffAverage ğ•œ hf uniformContinuous_id continuous_const\n  refine closure_minimal (Set.forall_mem_range.2 fun x â†¦ ?_) this (hg_ker hy)\n  /- Finally, for `y = f x - x` the average is equal to the difference between averages\n  along the orbits of `f x` and `x`, and most of the terms cancel. -/\n  have : IsBounded (Set.range (_root_.id <| f^[Â·] x)) :=\n    isBounded_iff_forall_norm_le.2 âŸ¨â€–xâ€–, Set.forall_mem_range.2 fun n â†¦ by\n      have H : f^[n] 0 = 0 := iterate_map_zero (f : E â†’+ E) n\n      simpa [H] using (hf.iterate n).dist_le_mul x 0âŸ©\n  have H : âˆ€ n x y, f^[n] (x - y) = f^[n] x - f^[n] y := iterate_map_sub (f : E â†’+ E)\n  simpa [birkhoffAverage, birkhoffSum, Finset.sum_sub_distrib, smul_sub, H]\n    using tendsto_birkhoffAverage_apply_sub_birkhoffAverage ğ•œ this\n\n"}
{"name":"ContinuousLinearMap.tendsto_birkhoffAverage_orthogonalProjection","module":"Mathlib.Analysis.InnerProductSpace.MeanErgodic","initialProofState":"ğ•œ : Type u_1\nE : Type u_2\ninstâœÂ³ : RCLike ğ•œ\ninstâœÂ² : NormedAddCommGroup E\ninstâœÂ¹ : InnerProductSpace ğ•œ E\ninstâœ : CompleteSpace E\nf : ContinuousLinearMap (RingHom.id ğ•œ) E E\nhf : LE.le (Norm.norm f) 1\nx : E\nâŠ¢ Filter.Tendsto (fun x_1 => birkhoffAverage ğ•œ (â‡‘f) id x_1 x) Filter.atTop (nhds â†‘((orthogonalProjection (LinearMap.eqLocus f 1)) x))","decl":"/-- **Von Neumann Mean Ergodic Theorem** for an operator in a Hilbert space.\nFor a contracting continuous linear self-map `f : E â†’L[ğ•œ] E` of a Hilbert space, `â€–fâ€– â‰¤ 1`,\nthe Birkhoff averages\n```\nbirkhoffAverage ğ•œ f id N x = (N : ğ•œ)â»Â¹ â€¢ âˆ‘ n âˆˆ Finset.range N, f^[n] x\n```\nconverge to the orthogonal projection of `x` to the subspace of fixed points of `f`. -/\ntheorem ContinuousLinearMap.tendsto_birkhoffAverage_orthogonalProjection (f : E â†’L[ğ•œ] E)\n    (hf : â€–fâ€– â‰¤ 1) (x : E) :\n    Tendsto (birkhoffAverage ğ•œ f _root_.id Â· x) atTop\n      (ğ“ <| orthogonalProjection (LinearMap.eqLocus f 1) x) := by\n  /- Due to the previous theorem, it suffices to verify\n  that the range of `f - 1` is dense in the orthogonal complement\n  to the submodule of fixed points of `f`. -/\n  apply (f : E â†’â‚—[ğ•œ] E).tendsto_birkhoffAverage_of_ker_subset_closure (f.lipschitz.weaken hf)\n  Â· exact orthogonalProjection_mem_subspace_eq_self (K := LinearMap.eqLocus f 1)\n  Â· clear x\n    /- In other words, we need to verify that any vector that is orthogonal to the range of `f - 1`\n    is a fixed point of `f`. -/\n    rw [ker_orthogonalProjection, â† Submodule.topologicalClosure_coe, SetLike.coe_subset_coe,\n      â† Submodule.orthogonal_orthogonal_eq_closure]\n    /- To verify this, we verify `â€–f xâ€– â‰¤ â€–xâ€–` (because `â€–fâ€– â‰¤ 1`) and `âŸªf x, xâŸ« = â€–xâ€–Â²`. -/\n    refine Submodule.orthogonal_le fun x hx â†¦ eq_of_norm_le_re_inner_eq_norm_sq (ğ•œ := ğ•œ) ?_ ?_\n    Â· simpa using f.le_of_opNorm_le hf x\n    Â· have : âˆ€ y, âŸªf y, xâŸ« = âŸªy, xâŸ« := by\n        simpa [Submodule.mem_orthogonal, inner_sub_left, sub_eq_zero] using hx\n      simp [this, â† norm_sq_eq_inner]\n"}
