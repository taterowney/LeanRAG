{"name":"MeasureTheory.Measure.everywherePosSubset_subset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nâŠ¢ HasSubset.Subset (Î¼.everywherePosSubset s) s","decl":"lemma everywherePosSubset_subset (Î¼ : Measure Î±) (s : Set Î±) : Î¼.everywherePosSubset s âŠ† s :=\n  fun _x hx â†¦ hx.1\n\n"}
{"name":"MeasureTheory.Measure.exists_isOpen_everywherePosSubset_eq_diff","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nâŠ¢ Exists fun u => And (IsOpen u) (Eq (Î¼.everywherePosSubset s) (SDiff.sdiff s u))","decl":"/-- The everywhere positive subset of a set is obtained by removing an open set. -/\nlemma exists_isOpen_everywherePosSubset_eq_diff (Î¼ : Measure Î±) (s : Set Î±) :\n    âˆƒ u, IsOpen u âˆ§ Î¼.everywherePosSubset s = s \\ u := by\n  refine âŸ¨{x | âˆƒ n âˆˆ ğ“[s] x, Î¼ n = 0}, ?_, by ext x; simp [everywherePosSubset, zero_lt_iff]âŸ©\n  rw [isOpen_iff_mem_nhds]\n  intro x âŸ¨n, ns, hxâŸ©\n  rcases mem_nhdsWithin_iff_exists_mem_nhds_inter.1 ns with âŸ¨v, vx, hvâŸ©\n  rcases mem_nhds_iff.1 vx with âŸ¨w, wv, w_open, xwâŸ©\n  have A : w âŠ† {x | âˆƒ n âˆˆ ğ“[s] x, Î¼ n = 0} := by\n    intro y yw\n    refine âŸ¨s âˆ© w, inter_mem_nhdsWithin _ (w_open.mem_nhds yw), measure_mono_null ?_ hxâŸ©\n    rw [inter_comm]\n    exact (inter_subset_inter_left _ wv).trans hv\n  have B : w âˆˆ ğ“ x := w_open.mem_nhds xw\n  exact mem_of_superset B A\n\n"}
{"name":"MeasurableSet.everywherePosSubset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ² : TopologicalSpace Î±\ninstâœÂ¹ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœ : OpensMeasurableSpace Î±\nhs : MeasurableSet s\nâŠ¢ MeasurableSet (Î¼.everywherePosSubset s)","decl":"protected lemma _root_.MeasurableSet.everywherePosSubset [OpensMeasurableSpace Î±]\n    (hs : MeasurableSet s) :\n    MeasurableSet (Î¼.everywherePosSubset s) := by\n  rcases exists_isOpen_everywherePosSubset_eq_diff Î¼ s with âŸ¨u, u_open, huâŸ©\n  rw [hu]\n  exact hs.diff u_open.measurableSet\n\n"}
{"name":"IsClosed.everywherePosSubset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nhs : IsClosed s\nâŠ¢ IsClosed (Î¼.everywherePosSubset s)","decl":"protected lemma _root_.IsClosed.everywherePosSubset (hs : IsClosed s) :\n    IsClosed (Î¼.everywherePosSubset s) := by\n  rcases exists_isOpen_everywherePosSubset_eq_diff Î¼ s with âŸ¨u, u_open, huâŸ©\n  rw [hu]\n  exact hs.sdiff u_open\n\n"}
{"name":"IsCompact.everywherePosSubset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nhs : IsCompact s\nâŠ¢ IsCompact (Î¼.everywherePosSubset s)","decl":"protected lemma _root_.IsCompact.everywherePosSubset (hs : IsCompact s) :\n    IsCompact (Î¼.everywherePosSubset s) := by\n  rcases exists_isOpen_everywherePosSubset_eq_diff Î¼ s with âŸ¨u, u_open, huâŸ©\n  rw [hu]\n  exact hs.diff u_open\n\n"}
{"name":"MeasureTheory.Measure.measure_eq_zero_of_subset_diff_everywherePosSubset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns k : Set Î±\nhk : IsCompact k\nh'k : HasSubset.Subset k (SDiff.sdiff s (Î¼.everywherePosSubset s))\nâŠ¢ Eq (Î¼ k) 0","decl":"/-- Any compact set contained in `s \\ Î¼.everywherePosSubset s` has zero measure. -/\nlemma measure_eq_zero_of_subset_diff_everywherePosSubset\n    (hk : IsCompact k) (h'k : k âŠ† s \\ Î¼.everywherePosSubset s) : Î¼ k = 0 := by\n  apply hk.induction_on (p := fun t â†¦ Î¼ t = 0)\n  Â· exact measure_empty\n  Â· exact fun s t hst ht â†¦ measure_mono_null hst ht\n  Â· exact fun s t hs ht â†¦ measure_union_null hs ht\n  Â· intro x hx\n    obtain âŸ¨u, ux, huâŸ© : âˆƒ u âˆˆ ğ“[s] x, Î¼ u = 0 := by\n      simpa [everywherePosSubset, (h'k hx).1] using (h'k hx).2\n    exact âŸ¨u, nhdsWithin_mono x (h'k.trans diff_subset) ux, huâŸ©\n\n"}
{"name":"MeasureTheory.Measure.everywherePosSubset_ae_eq","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ³ : TopologicalSpace Î±\ninstâœÂ² : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœÂ¹ : OpensMeasurableSpace Î±\ninstâœ : Î¼.InnerRegular\nhs : MeasurableSet s\nâŠ¢ (MeasureTheory.ae Î¼).EventuallyEq (Î¼.everywherePosSubset s) s","decl":"/-- In a space with an inner regular measure, any measurable set coincides almost everywhere with\nits everywhere positive subset. -/\nlemma everywherePosSubset_ae_eq [OpensMeasurableSpace Î±] [InnerRegular Î¼] (hs : MeasurableSet s) :\n    Î¼.everywherePosSubset s =áµ[Î¼] s := by\n  simp only [ae_eq_set, diff_eq_empty.mpr (everywherePosSubset_subset Î¼ s), measure_empty,\n    true_and, (hs.diff hs.everywherePosSubset).measure_eq_iSup_isCompact, ENNReal.iSup_eq_zero]\n  intro k hk h'k\n  exact measure_eq_zero_of_subset_diff_everywherePosSubset h'k hk\n\n"}
{"name":"MeasureTheory.Measure.everywherePosSubset_ae_eq_of_measure_ne_top","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ³ : TopologicalSpace Î±\ninstâœÂ² : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœÂ¹ : OpensMeasurableSpace Î±\ninstâœ : Î¼.InnerRegularCompactLTTop\nhs : MeasurableSet s\nh's : Ne (Î¼ s) Top.top\nâŠ¢ (MeasureTheory.ae Î¼).EventuallyEq (Î¼.everywherePosSubset s) s","decl":"/-- In a space with an inner regular measure for finite measure sets, any measurable set of finite\nmeasure coincides almost everywhere with its everywhere positive subset. -/\nlemma everywherePosSubset_ae_eq_of_measure_ne_top\n    [OpensMeasurableSpace Î±] [InnerRegularCompactLTTop Î¼] (hs : MeasurableSet s) (h's : Î¼ s â‰  âˆ) :\n    Î¼.everywherePosSubset s =áµ[Î¼] s := by\n  have A : Î¼ (s \\ Î¼.everywherePosSubset s) â‰  âˆ :=\n    ((measure_mono diff_subset).trans_lt h's.lt_top).ne\n  simp only [ae_eq_set, diff_eq_empty.mpr (everywherePosSubset_subset Î¼ s), measure_empty,\n    true_and, (hs.diff hs.everywherePosSubset).measure_eq_iSup_isCompact_of_ne_top A,\n    ENNReal.iSup_eq_zero]\n  intro k hk h'k\n  exact measure_eq_zero_of_subset_diff_everywherePosSubset h'k hk\n\n"}
{"name":"MeasureTheory.Measure.isEverywherePos_everywherePosSubset","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ³ : TopologicalSpace Î±\ninstâœÂ² : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœÂ¹ : OpensMeasurableSpace Î±\ninstâœ : Î¼.InnerRegular\nhs : MeasurableSet s\nâŠ¢ Î¼.IsEverywherePos (Î¼.everywherePosSubset s)","decl":"/-- In a space with an inner regular measure, the everywhere positive subset of a measurable set\nis itself everywhere positive. This is not obvious as `Î¼.everywherePosSubset s` is defined as\nthe points whose neighborhoods intersect `s` along positive measure subsets, but this does not\nsay they also intersect `Î¼.everywherePosSubset s` along positive measure subsets. -/\nlemma isEverywherePos_everywherePosSubset\n    [OpensMeasurableSpace Î±] [InnerRegular Î¼] (hs : MeasurableSet s) :\n    Î¼.IsEverywherePos (Î¼.everywherePosSubset s) := by\n  intro x hx n hn\n  rcases mem_nhdsWithin_iff_exists_mem_nhds_inter.1 hn with âŸ¨u, u_mem, huâŸ©\n  have A : 0 < Î¼ (u âˆ© s) := by\n    have : u âˆ© s âˆˆ ğ“[s] x := by rw [inter_comm]; exact inter_mem_nhdsWithin s u_mem\n    exact hx.2 _ this\n  have B : (u âˆ© Î¼.everywherePosSubset s : Set Î±) =áµ[Î¼] (u âˆ© s : Set Î±) :=\n    ae_eq_set_inter (ae_eq_refl _) (everywherePosSubset_ae_eq hs)\n  rw [â† B.measure_eq] at A\n  exact A.trans_le (measure_mono hu)\n\n"}
{"name":"MeasureTheory.Measure.isEverywherePos_everywherePosSubset_of_measure_ne_top","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ³ : TopologicalSpace Î±\ninstâœÂ² : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœÂ¹ : OpensMeasurableSpace Î±\ninstâœ : Î¼.InnerRegularCompactLTTop\nhs : MeasurableSet s\nh's : Ne (Î¼ s) Top.top\nâŠ¢ Î¼.IsEverywherePos (Î¼.everywherePosSubset s)","decl":"/-- In a space with an inner regular measure for finite measure sets, the everywhere positive subset\nof a measurable set of finite measure is itself everywhere positive. This is not obvious as\n`Î¼.everywherePosSubset s` is defined as the points whose neighborhoods intersect `s` along positive\nmeasure subsets, but this does not say they also intersect `Î¼.everywherePosSubset s` along positive\nmeasure subsets. -/\nlemma isEverywherePos_everywherePosSubset_of_measure_ne_top\n    [OpensMeasurableSpace Î±] [InnerRegularCompactLTTop Î¼] (hs : MeasurableSet s) (h's : Î¼ s â‰  âˆ) :\n    Î¼.IsEverywherePos (Î¼.everywherePosSubset s) := by\n  intro x hx n hn\n  rcases mem_nhdsWithin_iff_exists_mem_nhds_inter.1 hn with âŸ¨u, u_mem, huâŸ©\n  have A : 0 < Î¼ (u âˆ© s) := by\n    have : u âˆ© s âˆˆ ğ“[s] x := by rw [inter_comm]; exact inter_mem_nhdsWithin s u_mem\n    exact hx.2 _ this\n  have B : (u âˆ© Î¼.everywherePosSubset s : Set Î±) =áµ[Î¼] (u âˆ© s : Set Î±) :=\n    ae_eq_set_inter (ae_eq_refl _) (everywherePosSubset_ae_eq_of_measure_ne_top hs h's)\n  rw [â† B.measure_eq] at A\n  exact A.trans_le (measure_mono hu)\n\n"}
{"name":"MeasureTheory.Measure.IsEverywherePos.smul_measure","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nhs : Î¼.IsEverywherePos s\nc : ENNReal\nhc : Ne c 0\nâŠ¢ (HSMul.hSMul c Î¼).IsEverywherePos s","decl":"lemma IsEverywherePos.smul_measure (hs : IsEverywherePos Î¼ s) {c : â„â‰¥0âˆ} (hc : c â‰  0) :\n    IsEverywherePos (c â€¢ Î¼) s :=\n  fun x hx n hn â†¦ by simpa [hc.bot_lt, hs x hx n hn] using hc.bot_lt\n\n"}
{"name":"MeasureTheory.Measure.IsEverywherePos.smul_measure_nnreal","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\nhs : Î¼.IsEverywherePos s\nc : NNReal\nhc : Ne c 0\nâŠ¢ (HSMul.hSMul c Î¼).IsEverywherePos s","decl":"lemma IsEverywherePos.smul_measure_nnreal (hs : IsEverywherePos Î¼ s) {c : â„â‰¥0} (hc : c â‰  0) :\n    IsEverywherePos (c â€¢ Î¼) s :=\n  hs.smul_measure (by simpa using hc)\n\n"}
{"name":"MeasureTheory.Measure.IsEverywherePos.of_forall_exists_nhds_eq","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ Î½ : MeasureTheory.Measure Î±\ns : Set Î±\nhs : Î¼.IsEverywherePos s\nh : âˆ€ (x : Î±), Membership.mem s x â†’ Exists fun t => And (Membership.mem (nhds x) t) (âˆ€ (u : Set Î±), HasSubset.Subset u t â†’ Eq (Î½ u) (Î¼ u))\nâŠ¢ Î½.IsEverywherePos s","decl":"/-- If two measures coincide locally, then a set which is everywhere positive for the former is\nalso everywhere positive for the latter. -/\nlemma IsEverywherePos.of_forall_exists_nhds_eq (hs : IsEverywherePos Î¼ s)\n    (h : âˆ€ x âˆˆ s, âˆƒ t âˆˆ ğ“ x, âˆ€ u âŠ† t, Î½ u = Î¼ u) : IsEverywherePos Î½ s := by\n  intro x hx n hn\n  rcases h x hx with âŸ¨t, t_mem, htâŸ©\n  refine lt_of_lt_of_le ?_ (measure_mono (inter_subset_left (t := t)))\n  rw [ht (n âˆ© t) inter_subset_right]\n  exact hs x hx _ (inter_mem hn (mem_nhdsWithin_of_mem_nhds t_mem))\n\n"}
{"name":"MeasureTheory.Measure.isEverywherePos_iff_of_forall_exists_nhds_eq","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ¹ : TopologicalSpace Î±\ninstâœ : MeasurableSpace Î±\nÎ¼ Î½ : MeasureTheory.Measure Î±\ns : Set Î±\nh : âˆ€ (x : Î±), Membership.mem s x â†’ Exists fun t => And (Membership.mem (nhds x) t) (âˆ€ (u : Set Î±), HasSubset.Subset u t â†’ Eq (Î½ u) (Î¼ u))\nâŠ¢ Iff (Î½.IsEverywherePos s) (Î¼.IsEverywherePos s)","decl":"/-- If two measures coincide locally, then a set is everywhere positive for the former iff it is\neverywhere positive for the latter. -/\nlemma isEverywherePos_iff_of_forall_exists_nhds_eq (h : âˆ€ x âˆˆ s, âˆƒ t âˆˆ ğ“ x, âˆ€ u âŠ† t, Î½ u = Î¼ u) :\n    IsEverywherePos Î½ s â†” IsEverywherePos Î¼ s := by\n  refine âŸ¨fun H â†¦ H.of_forall_exists_nhds_eq ?_, fun H â†¦ H.of_forall_exists_nhds_eq hâŸ©\n  intro x hx\n  rcases h x hx with âŸ¨t, ht, h'tâŸ©\n  exact âŸ¨t, ht, fun u hu â†¦ (h't u hu).symmâŸ©\n\n"}
{"name":"IsOpen.isEverywherePos","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"Î± : Type u_1\ninstâœÂ² : TopologicalSpace Î±\ninstâœÂ¹ : MeasurableSpace Î±\nÎ¼ : MeasureTheory.Measure Î±\ns : Set Î±\ninstâœ : Î¼.IsOpenPosMeasure\nhs : IsOpen s\nâŠ¢ Î¼.IsEverywherePos s","decl":"/-- An open set is everywhere positive for a measure which is positive on open sets. -/\nlemma _root_.IsOpen.isEverywherePos [IsOpenPosMeasure Î¼] (hs : IsOpen s) : IsEverywherePos Î¼ s := by\n  intro x xs n hn\n  rcases mem_nhdsWithin.1 hn with âŸ¨u, u_open, xu, huâŸ©\n  apply lt_of_lt_of_le _ (measure_mono hu)\n  exact (u_open.inter hs).measure_pos Î¼ âŸ¨x, âŸ¨xu, xsâŸ©âŸ©\n\n"}
{"name":"MeasureTheory.Measure.IsEverywherePos.IsGdelta_of_isMulLeftInvariant","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"G : Type u_2\ninstâœâ¸ : Group G\ninstâœâ· : TopologicalSpace G\ninstâœâ¶ : TopologicalGroup G\ninstâœâµ : LocallyCompactSpace G\ninstâœâ´ : MeasurableSpace G\ninstâœÂ³ : BorelSpace G\nÎ¼ : MeasureTheory.Measure G\ninstâœÂ² : Î¼.IsMulLeftInvariant\ninstâœÂ¹ : MeasureTheory.IsFiniteMeasureOnCompacts Î¼\ninstâœ : Î¼.InnerRegularCompactLTTop\nk : Set G\nh : Î¼.IsEverywherePos k\nhk : IsCompact k\nh'k : IsClosed k\nâŠ¢ IsGÎ´ k","decl":"/-- If a compact closed set is everywhere positive with respect to a left-invariant measure on a\ntopological group, then it is a GÎ´ set. This is nontrivial, as there is no second-countability or\nmetrizability assumption in the statement, so a general compact closed set has no reason to be\na countable intersection of open sets. -/\n@[to_additive]\nlemma IsEverywherePos.IsGdelta_of_isMulLeftInvariant\n    {k : Set G} (h : Î¼.IsEverywherePos k) (hk : IsCompact k) (h'k : IsClosed k) :\n    IsGÎ´ k := by\n  /- Consider a decreasing sequence of open neighborhoods `Vâ‚™` of the identity, such that `g k \\ k`\n  has small measure for all `g âˆˆ Vâ‚™`. We claim that `k = â‹‚ Vâ‚™ k`, which proves\n  the lemma as the sets on the right are open. The inclusion `âŠ†` is trivial.\n  Let us show the converse. Take `x` in the intersection. For each `n`, write `x = vâ‚™ yâ‚™` with\n  `vâ‚™ âˆˆ Vâ‚™` and `yâ‚™ âˆˆ k`. Let `z âˆˆ k` be a cluster value of `yâ‚™`, by compactness. As multiplication\n  by `vâ‚™ = x yâ‚™â»Â¹ âˆˆ Vâ‚™` changes the measure of `k` by very little, passing to the limit we get\n  `Î¼ (x zâ»Â¹ k \\ k) = 0`. By invariance of the measure under `z x â»Â¹`, we get `Î¼ (k \\ z xâ»Â¹ k) = 0`.\n  Assume `x âˆ‰ k`. Then `z âˆˆ k \\ z xâ»Â¹ k`. Even more, this set is a neighborhood of `z` within `k`\n  (as `z xâ»Â¹ k` is closed), and it has zero measure. This contradicts the fact that `k` has\n  positive measure around the point `z`. -/\n  obtain âŸ¨u, -, u_mem, u_limâŸ© : âˆƒ u, StrictAnti u âˆ§ (âˆ€ (n : â„•), u n âˆˆ Ioo 0 1)\n    âˆ§ Tendsto u atTop (ğ“ 0) := exists_seq_strictAnti_tendsto' (zero_lt_one : (0 : â„â‰¥0âˆ) < 1)\n  have : âˆ€ n, âˆƒ (W : Set G), IsOpen W âˆ§ 1 âˆˆ W âˆ§ âˆ€ g âˆˆ W * W, Î¼ ((g â€¢ k) \\ k) < u n :=\n    fun n â†¦ exists_open_nhds_one_mul_subset\n      (eventually_nhds_one_measure_smul_diff_lt hk h'k (u_mem n).1.ne')\n  choose W W_open mem_W hW using this\n  let V n := â‹‚ i âˆˆ Finset.range n, W i\n  suffices â‹‚ n, V n * k âŠ† k by\n    replace : k = â‹‚ n, V n * k := by\n      apply Subset.antisymm (subset_iInter_iff.2 (fun n â†¦ ?_)) this\n      exact subset_mul_right k (by simp [V, mem_W])\n    rw [this]\n    refine .iInter_of_isOpen fun n â†¦ ?_\n    exact .mul_right (isOpen_biInter_finset (fun i _hi â†¦ W_open i))\n  intro x hx\n  choose v hv y hy hvy using mem_iInter.1 hx\n  obtain âŸ¨z, zk, hzâŸ© : âˆƒ z âˆˆ k, MapClusterPt z atTop y := hk.exists_mapClusterPt (by simp [hy])\n  have A n : Î¼ (((x * z â»Â¹) â€¢ k) \\ k) â‰¤ u n := by\n    apply le_of_lt (hW _ _ ?_)\n    have : W n * {z} âˆˆ ğ“ z := (IsOpen.mul_right (W_open n)).mem_nhds (by simp [mem_W])\n    obtain âŸ¨i, hi, niâŸ© : âˆƒ i, y i âˆˆ W n * {z} âˆ§ n < i :=\n      ((mapClusterPt_iff.1 hz _ this).and_eventually (eventually_gt_atTop n)).exists\n    refine âŸ¨x * (y i) â»Â¹, ?_, y i * zâ»Â¹, by simpa using hi, by groupâŸ©\n    have I : V i âŠ† W n := iInterâ‚‚_subset n (by simp [ni])\n    have J : x * (y i) â»Â¹ âˆˆ V i := by simpa [â† hvy i] using hv i\n    exact I J\n  have B : Î¼ (((x * z â»Â¹) â€¢ k) \\ k) = 0 :=\n    le_antisymm (ge_of_tendsto u_lim (Eventually.of_forall A)) bot_le\n  have C : Î¼ (k \\ (z * xâ»Â¹) â€¢ k) = 0 := by\n    have : Î¼ ((z * xâ»Â¹) â€¢ (((x * z â»Â¹) â€¢ k) \\ k)) = 0 := by rwa [measure_smul]\n    rw [â† this, smul_set_sdiff, smul_smul]\n    group\n    simp\n  by_contra H\n  have : k âˆ© ((z * xâ»Â¹) â€¢ k)á¶œ âˆˆ ğ“[k] z := by\n    apply inter_mem_nhdsWithin k\n    apply IsOpen.mem_nhds (by simpa using h'k.smul _)\n    simp only [mem_compl_iff]\n    contrapose! H\n    simpa [mem_smul_set_iff_inv_smul_mem] using H\n  have : 0 < Î¼ (k \\ ((z * xâ»Â¹) â€¢ k)) := h z zk _ this\n  exact lt_irrefl _ (C.le.trans_lt this)\n\n"}
{"name":"MeasureTheory.Measure.IsEverywherePos.IsGdelta_of_isAddLeftInvariant","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"G : Type u_2\ninstâœâ¸ : AddGroup G\ninstâœâ· : TopologicalSpace G\ninstâœâ¶ : TopologicalAddGroup G\ninstâœâµ : LocallyCompactSpace G\ninstâœâ´ : MeasurableSpace G\ninstâœÂ³ : BorelSpace G\nÎ¼ : MeasureTheory.Measure G\ninstâœÂ² : Î¼.IsAddLeftInvariant\ninstâœÂ¹ : MeasureTheory.IsFiniteMeasureOnCompacts Î¼\ninstâœ : Î¼.InnerRegularCompactLTTop\nk : Set G\nh : Î¼.IsEverywherePos k\nhk : IsCompact k\nh'k : IsClosed k\nâŠ¢ IsGÎ´ k","decl":"/-- If a compact closed set is everywhere positive with respect to a left-invariant measure on a\ntopological group, then it is a GÎ´ set. This is nontrivial, as there is no second-countability or\nmetrizability assumption in the statement, so a general compact closed set has no reason to be\na countable intersection of open sets. -/\n@[to_additive]\nlemma IsEverywherePos.IsGdelta_of_isMulLeftInvariant\n    {k : Set G} (h : Î¼.IsEverywherePos k) (hk : IsCompact k) (h'k : IsClosed k) :\n    IsGÎ´ k := by\n  /- Consider a decreasing sequence of open neighborhoods `Vâ‚™` of the identity, such that `g k \\ k`\n  has small measure for all `g âˆˆ Vâ‚™`. We claim that `k = â‹‚ Vâ‚™ k`, which proves\n  the lemma as the sets on the right are open. The inclusion `âŠ†` is trivial.\n  Let us show the converse. Take `x` in the intersection. For each `n`, write `x = vâ‚™ yâ‚™` with\n  `vâ‚™ âˆˆ Vâ‚™` and `yâ‚™ âˆˆ k`. Let `z âˆˆ k` be a cluster value of `yâ‚™`, by compactness. As multiplication\n  by `vâ‚™ = x yâ‚™â»Â¹ âˆˆ Vâ‚™` changes the measure of `k` by very little, passing to the limit we get\n  `Î¼ (x zâ»Â¹ k \\ k) = 0`. By invariance of the measure under `z x â»Â¹`, we get `Î¼ (k \\ z xâ»Â¹ k) = 0`.\n  Assume `x âˆ‰ k`. Then `z âˆˆ k \\ z xâ»Â¹ k`. Even more, this set is a neighborhood of `z` within `k`\n  (as `z xâ»Â¹ k` is closed), and it has zero measure. This contradicts the fact that `k` has\n  positive measure around the point `z`. -/\n  obtain âŸ¨u, -, u_mem, u_limâŸ© : âˆƒ u, StrictAnti u âˆ§ (âˆ€ (n : â„•), u n âˆˆ Ioo 0 1)\n    âˆ§ Tendsto u atTop (ğ“ 0) := exists_seq_strictAnti_tendsto' (zero_lt_one : (0 : â„â‰¥0âˆ) < 1)\n  have : âˆ€ n, âˆƒ (W : Set G), IsOpen W âˆ§ 1 âˆˆ W âˆ§ âˆ€ g âˆˆ W * W, Î¼ ((g â€¢ k) \\ k) < u n :=\n    fun n â†¦ exists_open_nhds_one_mul_subset\n      (eventually_nhds_one_measure_smul_diff_lt hk h'k (u_mem n).1.ne')\n  choose W W_open mem_W hW using this\n  let V n := â‹‚ i âˆˆ Finset.range n, W i\n  suffices â‹‚ n, V n * k âŠ† k by\n    replace : k = â‹‚ n, V n * k := by\n      apply Subset.antisymm (subset_iInter_iff.2 (fun n â†¦ ?_)) this\n      exact subset_mul_right k (by simp [V, mem_W])\n    rw [this]\n    refine .iInter_of_isOpen fun n â†¦ ?_\n    exact .mul_right (isOpen_biInter_finset (fun i _hi â†¦ W_open i))\n  intro x hx\n  choose v hv y hy hvy using mem_iInter.1 hx\n  obtain âŸ¨z, zk, hzâŸ© : âˆƒ z âˆˆ k, MapClusterPt z atTop y := hk.exists_mapClusterPt (by simp [hy])\n  have A n : Î¼ (((x * z â»Â¹) â€¢ k) \\ k) â‰¤ u n := by\n    apply le_of_lt (hW _ _ ?_)\n    have : W n * {z} âˆˆ ğ“ z := (IsOpen.mul_right (W_open n)).mem_nhds (by simp [mem_W])\n    obtain âŸ¨i, hi, niâŸ© : âˆƒ i, y i âˆˆ W n * {z} âˆ§ n < i :=\n      ((mapClusterPt_iff.1 hz _ this).and_eventually (eventually_gt_atTop n)).exists\n    refine âŸ¨x * (y i) â»Â¹, ?_, y i * zâ»Â¹, by simpa using hi, by groupâŸ©\n    have I : V i âŠ† W n := iInterâ‚‚_subset n (by simp [ni])\n    have J : x * (y i) â»Â¹ âˆˆ V i := by simpa [â† hvy i] using hv i\n    exact I J\n  have B : Î¼ (((x * z â»Â¹) â€¢ k) \\ k) = 0 :=\n    le_antisymm (ge_of_tendsto u_lim (Eventually.of_forall A)) bot_le\n  have C : Î¼ (k \\ (z * xâ»Â¹) â€¢ k) = 0 := by\n    have : Î¼ ((z * xâ»Â¹) â€¢ (((x * z â»Â¹) â€¢ k) \\ k)) = 0 := by rwa [measure_smul]\n    rw [â† this, smul_set_sdiff, smul_smul]\n    group\n    simp\n  by_contra H\n  have : k âˆ© ((z * xâ»Â¹) â€¢ k)á¶œ âˆˆ ğ“[k] z := by\n    apply inter_mem_nhdsWithin k\n    apply IsOpen.mem_nhds (by simpa using h'k.smul _)\n    simp only [mem_compl_iff]\n    contrapose! H\n    simpa [mem_smul_set_iff_inv_smul_mem] using H\n  have : 0 < Î¼ (k \\ ((z * xâ»Â¹) â€¢ k)) := h z zk _ this\n  exact lt_irrefl _ (C.le.trans_lt this)\n\n"}
{"name":"MeasureTheory.Measure.innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_group","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"G : Type u_2\ninstâœâ¸ : Group G\ninstâœâ· : TopologicalSpace G\ninstâœâ¶ : TopologicalGroup G\ninstâœâµ : LocallyCompactSpace G\ninstâœâ´ : MeasurableSpace G\ninstâœÂ³ : BorelSpace G\nÎ¼ : MeasureTheory.Measure G\ninstâœÂ² : Î¼.IsMulLeftInvariant\ninstâœÂ¹ : MeasureTheory.IsFiniteMeasureOnCompacts Î¼\ninstâœ : Î¼.InnerRegularCompactLTTop\nâŠ¢ Î¼.InnerRegularWRT (fun s => Exists fun f => And (Continuous f) (And (HasCompactSupport f) (Eq s (Set.preimage f (Singleton.singleton 1))))) fun s => And (MeasurableSet s) (Ne (Î¼ s) Top.top)","decl":"/-- **Halmos' theorem: Haar measure is completion regular.** More precisely, any finite measure\nset can be approximated from inside by a level set of a continuous function with compact support. -/\n@[to_additive innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_addGroup]\ntheorem innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_group :\n    InnerRegularWRT Î¼ (fun s â†¦ âˆƒ (f : G â†’ â„), Continuous f âˆ§ HasCompactSupport f âˆ§ s = f â»Â¹' {1})\n    (fun s â†¦ MeasurableSet s âˆ§ Î¼ s â‰  âˆ) := by\n  /- First, approximate a measurable set from inside by a compact closed set `K`. Then notice that\n  the everywhere positive subset of `K` is a GÎ´,\n  by Lemma `IsEverywherePos.IsGdelta_of_isMulLeftInvariant`, and therefore the level set of a\n  continuous compactly supported function. Moreover, it has the same measure as `K`. -/\n  apply InnerRegularWRT.trans _ innerRegularWRT_isCompact_isClosed_measure_ne_top_of_group\n  intro K âŸ¨K_comp, K_closedâŸ© r hr\n  let L := Î¼.everywherePosSubset K\n  have L_comp : IsCompact L := K_comp.everywherePosSubset\n  have L_closed : IsClosed L := K_closed.everywherePosSubset\n  refine âŸ¨L, everywherePosSubset_subset Î¼ K, ?_, ?_âŸ©\n  Â· have : Î¼.IsEverywherePos L :=\n      isEverywherePos_everywherePosSubset_of_measure_ne_top K_closed.measurableSet\n      K_comp.measure_lt_top.ne\n    have L_GÎ´ : IsGÎ´ L := this.IsGdelta_of_isMulLeftInvariant L_comp L_closed\n    obtain âŸ¨âŸ¨f, f_contâŸ©, Lf, -, f_comp, -âŸ© : âˆƒ f : C(G, â„), L = f â»Â¹' {1} âˆ§ EqOn f 0 âˆ…\n        âˆ§ HasCompactSupport f âˆ§ âˆ€ x, f x âˆˆ Icc (0 : â„) 1 :=\n      exists_continuous_one_zero_of_isCompact_of_isGÎ´ L_comp L_GÎ´ isClosed_empty\n        (disjoint_empty L)\n    exact âŸ¨f, f_cont, f_comp, LfâŸ©\n  Â· convert hr using 1\n    apply measure_congr\n    exact everywherePosSubset_ae_eq_of_measure_ne_top K_closed.measurableSet\n      K_comp.measure_lt_top.ne\n\n"}
{"name":"MeasureTheory.Measure.innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_addGroup","module":"Mathlib.MeasureTheory.Measure.EverywherePos","initialProofState":"G : Type u_2\ninstâœâ¸ : AddGroup G\ninstâœâ· : TopologicalSpace G\ninstâœâ¶ : TopologicalAddGroup G\ninstâœâµ : LocallyCompactSpace G\ninstâœâ´ : MeasurableSpace G\ninstâœÂ³ : BorelSpace G\nÎ¼ : MeasureTheory.Measure G\ninstâœÂ² : Î¼.IsAddLeftInvariant\ninstâœÂ¹ : MeasureTheory.IsFiniteMeasureOnCompacts Î¼\ninstâœ : Î¼.InnerRegularCompactLTTop\nâŠ¢ Î¼.InnerRegularWRT (fun s => Exists fun f => And (Continuous f) (And (HasCompactSupport f) (Eq s (Set.preimage f (Singleton.singleton 1))))) fun s => And (MeasurableSet s) (Ne (Î¼ s) Top.top)","decl":"/-- **Halmos' theorem: Haar measure is completion regular.** More precisely, any finite measure\nset can be approximated from inside by a level set of a continuous function with compact support. -/\n@[to_additive innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_addGroup]\ntheorem innerRegularWRT_preimage_one_hasCompactSupport_measure_ne_top_of_group :\n    InnerRegularWRT Î¼ (fun s â†¦ âˆƒ (f : G â†’ â„), Continuous f âˆ§ HasCompactSupport f âˆ§ s = f â»Â¹' {1})\n    (fun s â†¦ MeasurableSet s âˆ§ Î¼ s â‰  âˆ) := by\n  /- First, approximate a measurable set from inside by a compact closed set `K`. Then notice that\n  the everywhere positive subset of `K` is a GÎ´,\n  by Lemma `IsEverywherePos.IsGdelta_of_isMulLeftInvariant`, and therefore the level set of a\n  continuous compactly supported function. Moreover, it has the same measure as `K`. -/\n  apply InnerRegularWRT.trans _ innerRegularWRT_isCompact_isClosed_measure_ne_top_of_group\n  intro K âŸ¨K_comp, K_closedâŸ© r hr\n  let L := Î¼.everywherePosSubset K\n  have L_comp : IsCompact L := K_comp.everywherePosSubset\n  have L_closed : IsClosed L := K_closed.everywherePosSubset\n  refine âŸ¨L, everywherePosSubset_subset Î¼ K, ?_, ?_âŸ©\n  Â· have : Î¼.IsEverywherePos L :=\n      isEverywherePos_everywherePosSubset_of_measure_ne_top K_closed.measurableSet\n      K_comp.measure_lt_top.ne\n    have L_GÎ´ : IsGÎ´ L := this.IsGdelta_of_isMulLeftInvariant L_comp L_closed\n    obtain âŸ¨âŸ¨f, f_contâŸ©, Lf, -, f_comp, -âŸ© : âˆƒ f : C(G, â„), L = f â»Â¹' {1} âˆ§ EqOn f 0 âˆ…\n        âˆ§ HasCompactSupport f âˆ§ âˆ€ x, f x âˆˆ Icc (0 : â„) 1 :=\n      exists_continuous_one_zero_of_isCompact_of_isGÎ´ L_comp L_GÎ´ isClosed_empty\n        (disjoint_empty L)\n    exact âŸ¨f, f_cont, f_comp, LfâŸ©\n  Â· convert hr using 1\n    apply measure_congr\n    exact everywherePosSubset_ae_eq_of_measure_ne_top K_closed.measurableSet\n      K_comp.measure_lt_top.ne\n\n"}
